import{l as e,m as t,a,b as s,c as r,d as l,e as n,u as i,s as o,T as d,D as c,f as g,g as x,P as m,h as u,i as h}from"./feature-admin-CHHgr1nF.js";import{Q as b,z as p,e as y,f,g as v,u as j,b as k,R as N,j as w,L as C,d as S,r as T,c as I,h as A}from"./react-vendor-BM5hU6dt.js";import{c as E,p as M}from"./state-CKt5be-M.js";import{aF as R,g as D,N as F,m as _,o as L,Q as O,ab as H,p as $,aG as P,aH as B,ak as Q,e as z,X as G,a5 as K,al as U,l as q,i as V,a6 as W,as as J,T as Y,ax as Z,P as X,r as ee,aI as te,aJ as ae,at as se,s as re,aK as le,aw as ne,av as ie,U as oe,u as de,aL as ce,f as ge,ai as xe,y as me,q as ue,aM as he,aN as be,a4 as pe,aO as ye,Z as fe,v as ve,aP as je,t as ke,W as Ne,w as we,d as Ce,aq as Se,aB as Te,h as Ie,aQ as Ae,aR as Ee,x as Me,a9 as Re,aS as De,aT as Fe,aU as _e,ap as Le,V as Oe,am as He,aV as $e,aa as Pe,aW as Be,a7 as Qe,B as ze,ae as Ge,M as Ke,S as Ue,G as qe}from"./ui-libs-lSrfa2yz.js";import{B as Ve,C as We}from"./utils-DfzRL4Gc.js";import"./i18n-LIo75bdB.js";import{P as Je}from"./vendor-C-bTHPIS.js";const Ye={staleTime:{medium:3e5},gcTime:{medium:6e5}},Ze=new b({defaultOptions:{queries:{staleTime:Ye.staleTime.medium,cacheTime:Ye.gcTime.medium,refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!0,retry:2,retryDelay:e=>Math.min(1e3*2**e,3e4),onError:t=>{var a,s;e.error("Query Error:",t),(null==(s=null==(a=t.response)?void 0:a.data)?void 0:s.message)?p.error(t.response.data.message):t.message?p.error(t.message):p.error("Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.")}},mutations:{retry:0,onError:t=>{var a,s;e.error("Mutation Error:",t),(null==(s=null==(a=t.response)?void 0:a.data)?void 0:s.message)?p.error(t.response.data.message):t.message?p.error(t.message):p.error("Ä°ÅŸlem baÅŸarÄ±sÄ±z oldu. LÃ¼tfen tekrar deneyin.")}}}});e.info("React Query initialized (Production mode)",{staleTime:Ye.staleTime.medium/1e3+"s",gcTime:Ye.gcTime.medium/1e3+"s"});const Xe={all:()=>["conversations"],list:e=>["conversations","list",e],detail:e=>["conversations","detail",e],messages:(e,t)=>["conversations","messages",e,t],search:e=>["conversations","search",e]},et={all:()=>["agents"],list:e=>["agents","list",e],detail:e=>["agents","detail",e],my:()=>["agents","my"],workload:e=>["agents","workload",e],metrics:(e,t)=>["agents","metrics",e,t]},tt={tr:"tr-TR",en:"en-US"};function at(e){const t=e.split("-")[0].toLowerCase();return tt[t]||"en-US"}function st(e,t,a){const s=at(t);return e.toLocaleDateString(s,a)}function rt(e,t,a){const s=at(t);return e.toLocaleTimeString(s,a)}function lt(e,t,a="TRY"){const s=at(t);return e.toLocaleString(s,{style:"currency",currency:a})}const nt=E()(M((e,t)=>({status:"available",dailyBreakMinutes:30,usedBreakSeconds:0,breakStartTime:null,lastResetDate:(new Date).toDateString(),setStatus:a=>{const s=t();"on_break"===a&&"on_break"!==s.status?t().startBreak():"on_break"!==a&&"on_break"===s.status&&t().endBreak(),e({status:a})},setDailyBreakMinutes:t=>e({dailyBreakMinutes:t}),startBreak:()=>{const a=(new Date).toDateString();t().lastResetDate!==a&&t().resetDailyBreak(),e({breakStartTime:Date.now()})},endBreak:()=>{const a=t();if(a.breakStartTime){const t=Math.floor((Date.now()-a.breakStartTime)/1e3);e({usedBreakSeconds:a.usedBreakSeconds+t,breakStartTime:null})}},getRemainingBreakSeconds:()=>{const e=t(),a=60*e.dailyBreakMinutes;let s=e.usedBreakSeconds;if(e.breakStartTime){s+=Math.floor((Date.now()-e.breakStartTime)/1e3)}return Math.max(0,a-s)},resetDailyBreak:()=>{e({usedBreakSeconds:0,breakStartTime:null,lastResetDate:(new Date).toDateString()})}}),{name:"agent-status-storage"})),it={async getConversations(e){await t();let a=[...l];return(null==e?void 0:e.status)&&(a=a.filter(t=>t.status===e.status)),(null==e?void 0:e.channel)&&(a=a.filter(t=>t.channel===e.channel)),{conversations:a,total:a.length,page:1,pageSize:20}},async getConversationById(e){await t();return l.find(t=>t.id===e)||null},getMessages:async e=>(await t(),r[e]||[]),sendMessage:async(e,a)=>(await t(),{success:!0,messageId:`msg-${Date.now()}`,timestamp:(new Date).toISOString()}),updateConversationStatus:async(e,a)=>(await t(),{success:!0,conversationId:e,status:a}),assignConversation:async(e,a)=>(await t(),{success:!0,conversationId:e,agentId:a}),getStats:async()=>(await t(),s),getFilters:async()=>(await t(),a)},ot=async e=>({success:!0,data:(await it.getConversations(e)).conversations}),dt=async e=>({success:!0,data:{id:(await it.sendMessage(e.conversationId,e.content)).messageId,conversationId:e.conversationId,sender:"agent",content:e.content,timestamp:new Date,read:!0}}),ct=async e=>{await it.updateConversationStatus(e,"resolved");return{success:!0,data:{...await it.getConversationById(e),status:"resolved"}}},gt=async(e,t)=>{await it.assignConversation(e,t);return{success:!0,data:{...await it.getConversationById(e),assignedTo:"human",assignedAgent:t}}},xt=async e=>(await n.post(`/conversations/${e}/read`)).data,mt=async()=>(await n.get("/agents/me")).data,ut=async(e,t)=>(await n.post(`/smart-assignment/agents/${e}/status`,t)).data,ht=async(e,t)=>(await n.get(`/smart-assignment/agents/${e}/metrics`,{params:t})).data,bt=async e=>(await n.post("/auth/reset-password",{email:e})).data,pt=e=>{const t="assigned"===(null==e?void 0:e.status);return y(Xe.list(e),()=>ot(e),{select:e=>e.data,staleTime:t?12e4:3e4,refetchOnWindowFocus:!t,refetchOnMount:!t})},yt=({onItemClick:t,isCollapsed:a=!1,onToggleCollapse:s})=>{const{t:r}=j("agent"),l=k(),{user:n}=i(),{status:d,setStatus:c,getRemainingBreakSeconds:g,breakStartTime:x}=nt(),m=(()=>{const e=f();return v(({agentId:e,statusData:t})=>ut(e,t),{onMutate:async({agentId:t,statusData:a})=>{await e.cancelQueries(et.detail(t));const s=e.getQueryData(et.detail(t));return s&&e.setQueryData(et.detail(t),{...s,data:{...s.data,status:a.status}}),{previousAgent:s}},onSuccess:(t,a)=>{e.invalidateQueries(et.detail(a.agentId)),e.invalidateQueries(et.my()),e.invalidateQueries(et.list())},onError:(t,a,s)=>{(null==s?void 0:s.previousAgent)&&e.setQueryData(et.detail(a.agentId),s.previousAgent)}})})(),[u,h]=N.useState(!1),[b,p]=N.useState(0);N.useEffect(()=>{if("on_break"===d&&x){const e=setInterval(()=>{p(g())},1e3);return()=>clearInterval(e)}p(g())},[d,x,g]);const y=[{icon:R,label:r("sidebar.dashboard"),path:"/agent/dashboard",type:"link"},{icon:D,label:r("sidebar.conversations"),path:"/agent/conversations",type:"link"},{icon:F,label:r("sidebar.teamChat"),path:"/agent/team/chat",type:"link"},{icon:_,label:r("sidebar.aiAssistant"),path:"/agent/ai-chat",badge:r("sidebar.new"),type:"link"},{icon:L,label:r("sidebar.profile"),path:"/agent/profile",type:"link"}],S=[{value:"available",label:r("status.available"),icon:O,color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/30",textColor:"text-green-700 dark:text-green-400"},{value:"busy",label:r("status.busy"),icon:H,color:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/30",textColor:"text-red-700 dark:text-red-400"},{value:"away",label:r("status.away"),icon:$,color:"text-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",textColor:"text-yellow-700 dark:text-yellow-400"},{value:"on_break",label:r("status.onBreak"),icon:P,color:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/30",textColor:"text-orange-700 dark:text-orange-400"}],T=S.find(e=>e.value===d)||S[0],I=async t=>{if(!(null==n?void 0:n.id))return;c(t),h(!1);const a={available:r("status.messages.available"),busy:r("status.messages.busy"),away:r("status.messages.away"),on_break:r("status.messages.onBreak")};o(a[t]||r("status.updated"));try{const e="on_break"===t?"offline":t;await m.mutateAsync({agentId:n.id,statusData:{status:e}})}catch(s){e.error("Failed to update status",{error:s,newStatus:t})}};return w.jsx("div",{className:"flex h-full min-h-[700px] flex-col justify-between bg-slate-50 dark:bg-slate-900 p-4 transition-all duration-300 "+(a?"w-20":"w-80"),children:w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3 "+(a?"justify-center":""),children:[w.jsx("img",{src:"/logo.svg",alt:"AsistanApp",className:"w-8 h-8 flex-shrink-0"}),!a&&w.jsxs("div",{children:[w.jsx("h1",{className:"text-[#0e131b] dark:text-gray-100 text-base font-medium leading-normal",children:(null==n?void 0:n.name)||"Agent"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"AsistanApp"})]})]}),!a&&s&&w.jsx("button",{onClick:s,className:"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors","aria-label":r("layout.collapseSidebar"),children:w.jsx(B,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),a&&s&&w.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors mx-auto","aria-label":r("layout.expandSidebar"),children:w.jsx(Q,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),!a&&w.jsxs("div",{className:"relative p-3 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("status.label")}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:(null==n?void 0:n.name)||"Agent"})]}),w.jsxs("button",{onClick:()=>h(!u),className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg ${T.bgColor} hover:opacity-90 transition-all`,children:[w.jsxs("div",{className:"flex items-center gap-2.5",children:[w.jsx(T.icon,{className:`w-5 h-5 ${T.color}`}),w.jsxs("div",{className:"flex flex-col items-start",children:[w.jsx("span",{className:`text-sm font-semibold ${T.textColor}`,children:T.label}),"on_break"===d&&w.jsx("span",{className:"text-xs text-orange-600 dark:text-orange-400 font-mono",children:b>0?r("breakTimer.remaining",{time:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(b)}):r("breakTimer.timeUp")})]})]}),w.jsx("svg",{className:`w-4 h-4 ${T.textColor}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>h(!1)}),w.jsx("div",{className:"absolute left-3 right-3 mt-2 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl z-50 overflow-hidden",children:S.map(e=>{const t=e.icon;return w.jsxs("button",{onClick:()=>I(e.value),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors "+(d===e.value?"bg-gray-50 dark:bg-slate-700":""),children:[w.jsx(t,{className:`w-5 h-5 ${e.color}`}),w.jsx("span",{className:`text-sm font-medium ${e.textColor}`,children:e.label}),d===e.value&&w.jsx("svg",{className:"w-4 h-4 text-green-500 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.value)})})]})]}),a&&w.jsxs("div",{className:"flex justify-center p-2 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700",children:[w.jsx("button",{onClick:()=>h(!u),className:`p-2 rounded-lg ${T.bgColor}`,title:T.label,children:w.jsx(T.icon,{className:`w-5 h-5 ${T.color}`})}),u&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>h(!1)}),w.jsx("div",{className:"absolute left-20 top-0 mt-2 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl z-50 overflow-hidden min-w-[180px]",children:S.map(e=>{const t=e.icon;return w.jsxs("button",{onClick:()=>I(e.value),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors "+(d===e.value?"bg-gray-50 dark:bg-slate-700":""),children:[w.jsx(t,{className:`w-5 h-5 ${e.color}`}),w.jsx("span",{className:`text-sm font-medium ${e.textColor}`,children:e.label}),d===e.value&&w.jsx("svg",{className:"w-4 h-4 text-green-500 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.value)})})]})]}),w.jsx("div",{className:"flex flex-col gap-2",children:y.map((e,s)=>{const r=e.icon,n=(i=e.path)&&l.pathname===i;var i;return w.jsxs(C,{to:e.path,onClick:t,title:a?e.label:void 0,className:`flex items-center ${a?"justify-center":"gap-3"} px-3 py-2 rounded-xl transition-colors ${n?"bg-[#e7ecf3] dark:bg-slate-700":"hover:bg-[#e7ecf3]/50 dark:hover:bg-slate-700/50"}`,children:[w.jsx(r,{className:"text-[#0e131b] dark:text-gray-100 flex-shrink-0",size:24}),!a&&w.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[w.jsx("p",{className:"text-[#0e131b] dark:text-gray-100 text-sm font-medium leading-normal",children:e.label}),e.badge&&w.jsx("span",{className:"px-1.5 py-0.5 bg-green-500 text-white text-[10px] font-bold rounded uppercase",children:e.badge})]}),a&&e.badge&&w.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-green-500 rounded-full"})]},e.path)})})]})})},ft=({onClose:e})=>{const{t:t}=j("agent"),a=S(),[s,r]=T.useState([]),[l,n]=T.useState("all"),i=e=>{switch(e){case"new_conversation":return w.jsx(D,{className:"w-5 h-5 text-blue-500"});case"new_message":return w.jsx(D,{className:"w-5 h-5 text-green-500"});case"ai_stuck":return w.jsx(q,{className:"w-5 h-5 text-red-500"});case"assigned":return w.jsx(U,{className:"w-5 h-5 text-purple-500"});case"resolved":return w.jsx(O,{className:"w-5 h-5 text-teal-500"});case"mention":return w.jsx(D,{className:"w-5 h-5 text-orange-500"});default:return w.jsx(z,{className:"w-5 h-5 text-gray-500"})}},o=e=>{const a=Math.floor((Date.now()-e.getTime())/1e3);if(a<60)return t("common:time.secondsAgo",{count:a});const s=Math.floor(a/60);if(s<60)return t("common:time.minutesAgo",{count:s});const r=Math.floor(s/60);if(r<24)return t("common:time.hoursAgo",{count:r});const l=Math.floor(r/24);return t("common:time.daysAgo",{count:l})},d=T.useCallback(e=>{r(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},[]),c=T.useCallback(()=>{r(e=>e.map(e=>({...e,read:!0})))},[]),g=T.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),x=T.useCallback(t=>{if(d(t.id),"mention"===t.type&&t.channelId&&t.messageId)return a(`/agent/team/chat?channelId=${t.channelId}&messageId=${t.messageId}`),void e();t.route&&(a(t.route),e())},[d,a,e]),m=T.useMemo(()=>"unread"===l?s.filter(e=>!e.read):s,[s,l]),u=T.useMemo(()=>s.filter(e=>!e.read).length,[s]);return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20 px-4",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col",children:[w.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center relative",children:[w.jsx(z,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),u>0&&w.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:u})]}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:t("notifications.title")}),w.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t("notifications.unreadCount",{count:u})})]})]}),w.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors","aria-label":t("common:close"),type:"button",children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:()=>n("all"),className:"flex-1 px-3 py-1.5 text-sm font-medium rounded-lg transition-colors "+("all"===l?"bg-orange-500 text-white":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:t("notifications.filterAll",{count:s.length})}),w.jsx("button",{onClick:()=>n("unread"),className:"flex-1 px-3 py-1.5 text-sm font-medium rounded-lg transition-colors "+("unread"===l?"bg-orange-500 text-white":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:t("notifications.filterUnread",{count:u})}),u>0&&w.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:t("common.markAllRead"),children:w.jsx(K,{className:"w-5 h-5"})})]})]}),w.jsx("div",{className:"flex-1 overflow-y-auto",children:0===m.length?w.jsxs("div",{className:"p-8 text-center",children:[w.jsx(z,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("unread"===l?"notifications.emptyUnread":"notifications.empty")})]}):w.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:m.map(e=>w.jsx("div",{onClick:()=>x(e),className:"p-4 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors cursor-pointer "+(e.read?"":"bg-orange-50/50 dark:bg-orange-900/10"),children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx("div",{className:"flex-shrink-0 mt-1",children:i(e.type)}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[w.jsx("h3",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:e.title}),!e.read&&w.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full flex-shrink-0 mt-1.5"})]}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:e.message}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:o(e.timestamp)}),w.jsxs("div",{className:"flex items-center gap-2",children:[!e.read&&w.jsx("button",{onClick:t=>{t.stopPropagation(),d(e.id)},className:"text-xs text-orange-600 dark:text-orange-400 hover:underline",children:t("common:markAsRead")}),w.jsx("button",{onClick:t=>{t.stopPropagation(),g(e.id)},className:"text-xs text-red-600 dark:text-red-400 hover:underline",children:t("common:delete")})]})]})]})]})},e.id))})})]})})},vt=E((t,a)=>({activeCall:null,callQueue:[],isRinging:!1,isMuted:!1,currentAgentName:void 0,triggerEmergencyCall:e=>{a().activeCall?t(t=>({callQueue:[...t.callQueue,e]})):(t({activeCall:e,isRinging:!0}),"Notification"in window&&"granted"===Notification.permission&&new Notification("ðŸš¨ EMERGENCY CALL!",{body:`${e.customerName} needs urgent assistance!`,icon:e.customerAvatar||"/emergency-icon.png",tag:e.id,requireInteraction:!0}),"vibrate"in navigator&&navigator.vibrate([200,100,200,100,200,100,200]))},acceptCall:s=>{const r=a().activeCall;if(!r)return void e.debug("âŒ acceptCall: No active call!");e.debug("âœ… acceptCall called:",{agentName:s,callId:r.id});const l={...r,takenBy:{agentId:"current-agent-id",agentName:s,takenAt:new Date}};e.debug("ðŸ”„ Call accepted, redirecting to voice call screen..."),t({activeCall:l,isRinging:!1,currentAgentName:s}),e.debug("ðŸ“ž Redirecting to voice call screen:",{conversationId:r.conversationId}),window.location.href=`/agent/voice-call/${r.conversationId}`,setTimeout(()=>{t({activeCall:null});const e=a().callQueue;if(e.length>0){const s=e[0];t({callQueue:e.slice(1)}),a().triggerEmergencyCall(s)}},500)},rejectCall:e=>{if(!a().activeCall)return;t({activeCall:null,isRinging:!1});const s=a().callQueue;if(s.length>0){const e=s[0];t({callQueue:s.slice(1)}),setTimeout(()=>{a().triggerEmergencyCall(e)},1e3)}},dismissCall:()=>{t({activeCall:null,isRinging:!1})},toggleMute:()=>{t(e=>({isMuted:!e.isMuted}))},clearQueue:()=>{t({callQueue:[]})},setCurrentAgent:e=>{t({currentAgentName:e})}})),jt=E((t,a)=>({activeToast:null,showToast:a=>{e.info("[MentionNotificationStore] Toast shown",{toast:a}),t({activeToast:a})},dismissToast:()=>{e.info("[MentionNotificationStore] Toast dismissed"),t({activeToast:null})},simulateMention:()=>{a().showToast({channelId:"channel-1",messageId:"message-123",channelName:"general-chat",mentionedBy:"John Doe",message:"Hey @Test User, I need your review on this topic. What do you think?"}),e.info("[MentionNotificationStore] Test mention simulated")}})),kt=()=>{var e,t;const{t:a}=j("agent"),s=S(),r=f(),{user:l,logout:n}=i(),[c,g]=T.useState(!1),[x,m]=T.useState(!1),{status:u}=nt(),{triggerEmergencyCall:h}=vt(),{simulateMention:b}=jt(),p={available:{label:a("status.available"),icon:O,iconColor:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/30",textColor:"text-green-700 dark:text-green-400"},busy:{label:a("status.busy"),icon:H,iconColor:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/30",textColor:"text-red-700 dark:text-red-400"},away:{label:a("status.away"),icon:$,iconColor:"text-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",textColor:"text-yellow-700 dark:text-yellow-400"},on_break:{label:a("status.onBreak"),icon:P,iconColor:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/30",textColor:"text-orange-700 dark:text-orange-400"}},y=p[u]||p.available,v=y.icon;return w.jsxs("header",{className:"flex h-18 shrink-0 items-center justify-between border-b border-solid border-b-[#e7ecf3] dark:border-b-slate-700 bg-white dark:bg-slate-800 px-10 py-3 transition-colors",children:[w.jsx("div",{className:"flex items-center gap-4",children:w.jsx("h2",{className:"text-[#0e131b] dark:text-gray-100 text-lg font-bold leading-tight tracking-[-0.015em]",children:a("header.welcome")})}),w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${y.bgColor}`,children:[w.jsx(v,{className:`w-4 h-4 ${y.iconColor}`}),w.jsx("span",{className:`text-sm font-semibold ${y.textColor}`,children:y.label})]}),!1,w.jsxs("button",{onClick:()=>g(!0),className:"relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:[w.jsx(z,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),w.jsx(d,{}),w.jsxs("div",{className:"relative",children:[w.jsxs("button",{onClick:()=>m(!x),className:"flex items-center gap-3 pl-3 border-l border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-700 rounded-lg transition-colors px-2 py-1",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:(null==(e=null==l?void 0:l.name)?void 0:e.split(" ").map(e=>e[0]).join("").toUpperCase())||"A"}),w.jsxs("div",{className:"hidden md:block",children:[w.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:(null==l?void 0:l.name)||"Agent"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a("header.supportTeam")})]}),w.jsx(V,{className:"w-4 h-4 text-gray-600 dark:text-gray-400 hidden md:block"})]}),x&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>m(!1)}),w.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl z-50 overflow-hidden",children:[w.jsxs("button",{onClick:()=>{window.location.href="/agent/profile",m(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors text-left",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold",children:(null==(t=null==l?void 0:l.name)?void 0:t.split(" ").map(e=>e[0]).join("").toUpperCase())||"A"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a("header.myProfile")}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a("header.settingsPreferences")})]})]}),w.jsx("div",{className:"border-t border-gray-200 dark:border-slate-700"}),w.jsxs("button",{onClick:async()=>{r.clear(),await n(),o(a("auth.logoutSuccess")),s("/login")},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-left text-red-600 dark:text-red-400",children:[w.jsx(W,{className:"w-4 h-4"}),w.jsx("span",{className:"text-sm font-medium",children:a("auth.logout")})]})]})]})]})]}),c&&w.jsx(ft,{onClose:()=>g(!1)})]})},Nt=({channelId:e,messageId:t,channelName:a,mentionedBy:s,message:r,onDismiss:l})=>{const{t:n}=j("agent"),i=S();T.useEffect(()=>{const e=setTimeout(()=>{l()},5e3);return()=>clearTimeout(e)},[l]);return w.jsx("div",{className:"fixed bottom-6 right-6 z-[9999] animate-slide-in-right",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl border-2 border-orange-500 dark:border-orange-600 overflow-hidden max-w-sm",children:[w.jsxs("div",{className:"bg-orange-500 dark:bg-orange-600 px-4 py-2 flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2 text-white",children:[w.jsx(J,{className:"w-5 h-5"}),w.jsx("span",{className:"font-bold text-sm",children:n("notifications.mention")})]}),w.jsx("button",{onClick:l,className:"text-white hover:bg-orange-600 dark:hover:bg-orange-700 rounded p-1 transition-colors",type:"button","aria-label":n("common.close"),children:w.jsx(G,{className:"w-4 h-4"})})]}),w.jsxs("button",{onClick:()=>{i(`/agent/team/chat?channelId=${e}&messageId=${t}`),l()},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",type:"button",children:[w.jsx("div",{className:"flex items-start gap-3",children:w.jsxs("div",{className:"flex-1",children:[w.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:[s," ",n("notifications.mentionedYouIn")," #",a]}),w.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2",children:r})]})}),w.jsxs("div",{className:"mt-2 text-xs text-orange-600 dark:text-orange-400 font-medium",children:[n("notifications.clickToView")," â†’"]})]}),w.jsx("div",{className:"h-1 bg-gray-200 dark:bg-slate-700",children:w.jsx("div",{className:"h-full bg-orange-500 dark:bg-orange-600 animate-shrink-width"})})]})})},wt=({call:t,onAccept:a,onReject:s})=>{var r,l,n,i,o;const{t:d}=j("agent"),c=null==(r=t.aiHandling)?void 0:r.aiSummary,[g,x]=T.useState(0),[m,u]=T.useState(!1);T.useEffect(()=>{const t=setInterval(()=>{x(e=>e+1)},1e3),a=setTimeout(()=>{s()},3e4),r=new Audio("/sounds/incoming-call.mp3");return r.loop=!0,r.play().catch(t=>e.error("Failed to play ring sound",t)),()=>{clearInterval(t),clearTimeout(a),r.pause(),r.currentTime=0}},[s]);return w.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:w.jsxs("div",{className:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden animate-scale-in",children:[w.jsx("div",{className:"bg-gradient-to-r from-red-600 to-orange-600 p-4",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center animate-pulse",children:w.jsx(Y,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-bold text-white",children:d("voice.aiHandoff.title")}),w.jsx("p",{className:"text-sm text-white/80",children:(null==(l=t.aiHandling)?void 0:l.aiStuckReason)||d("voice.aiHandoff.defaultReason")})]})]}),w.jsxs("div",{className:"text-right",children:[w.jsx("p",{className:"text-2xl font-mono font-bold text-white",children:(h=g,`${Math.floor(h/60)}:${(h%60).toString().padStart(2,"0")}`)}),w.jsx("p",{className:"text-xs text-white/70",children:d("voice.waiting")})]})]})}),w.jsxs("div",{className:"p-6 space-y-4 max-h-[calc(90vh-200px)] overflow-y-auto",children:[w.jsxs("div",{className:"flex items-start gap-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800",children:[t.caller.avatar?w.jsx("img",{src:t.caller.avatar,alt:t.caller.name,className:"w-16 h-16 rounded-full border-4 border-white dark:border-slate-700 shadow-lg"}):w.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:w.jsx(L,{className:"w-8 h-8 text-white"})}),w.jsxs("div",{className:"flex-1",children:[w.jsx("h4",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t.caller.name}),t.caller.phoneNumber&&w.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:t.caller.phoneNumber}),w.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[w.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-xs font-semibold rounded",children:"internal"===t.callType?`ðŸ“ž ${d("voice.internalCall")}`:`ðŸ“± ${d("voice.externalCall")}`}),(null==(n=t.metadata)?void 0:n.priority)&&"normal"!==t.metadata.priority&&w.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded "+("urgent"===t.metadata.priority?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400"),children:"urgent"===t.metadata.priority?`ðŸš¨ ${d("voice.priority.urgent")}`:`âš¡ ${d("voice.priority.high")}`})]})]})]}),(null==(i=t.aiHandling)?void 0:i.aiDuration)&&w.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx(_,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),w.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[d("voice.aiHandoff.talkedFor")," ",w.jsxs("strong",{className:"text-purple-700 dark:text-purple-300",children:[Math.floor(t.aiHandling.aiDuration/60),":",(t.aiHandling.aiDuration%60).toString().padStart(2,"0")]})]})]})}),c&&w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(_,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),w.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white",children:d("voice.aiHandoff.summary")})]}),c.conversationContext&&w.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[w.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["ðŸ’¬ ",d("voice.aiHandoff.whatDiscussed")]}),w.jsxs("p",{className:"text-sm text-gray-900 dark:text-white italic",children:['"',c.conversationContext,'"']})]}),w.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx(Y,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-1",children:d("voice.aiHandoff.whyStuck")}),w.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:c.stuckReason})]})]})}),w.jsx("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx(F,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 flex-shrink-0 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("voice.aiHandoff.customerIntent")}),w.jsx("p",{className:"text-base text-gray-900 dark:text-white font-medium",children:c.customerIntent})]})]})}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:`p-3 rounded-lg border ${(e=>{switch(e){case"positive":return"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20";case"negative":return"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20";default:return"text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/20"}})(c.sentiment)}`,children:[w.jsx("p",{className:"text-xs font-medium mb-1",children:d("voice.aiHandoff.customerMood")}),w.jsxs("p",{className:"text-lg font-bold",children:[(e=>{switch(e){case"positive":return"ðŸ˜Š";case"negative":return"ðŸ˜Ÿ";default:return"ðŸ˜"}})(c.sentiment)," ","positive"===c.sentiment?d("voice.aiHandoff.sentiment.positive"):"negative"===c.sentiment?d("voice.aiHandoff.sentiment.negative"):d("voice.aiHandoff.sentiment.neutral")]})]}),w.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-900/20 rounded-lg border border-gray-200 dark:border-gray-700",children:[w.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:d("voice.aiHandoff.previousInteractions")}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx($,{className:"w-4 h-4 text-gray-500"}),w.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:c.previousInteractions})]}),c.lastInteractionDate&&w.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[d("voice.aiHandoff.last"),": ",c.lastInteractionDate]})]})]}),c.quickNotes&&c.quickNotes.length>0&&w.jsxs("div",{className:"space-y-2",children:[w.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["ðŸ’¡ ",d("voice.aiHandoff.quickNotes")]}),w.jsx("div",{className:"space-y-1",children:c.quickNotes.map((e,t)=>w.jsxs("div",{className:"flex items-start gap-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded border border-yellow-200 dark:border-yellow-800",children:[w.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:"â€¢"}),w.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})]},t))})]}),c.suggestedResponse&&w.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[w.jsxs("p",{className:"text-sm font-medium text-green-800 dark:text-green-200 mb-2",children:["âœ¨ ",d("voice.aiHandoff.suggestedResponse")]}),w.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 italic",children:['"',c.suggestedResponse,'"']})]})]}),(null==(o=t.metadata)?void 0:o.notes)&&w.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/20 rounded-lg border border-gray-200 dark:border-gray-700",children:[w.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["ðŸ“ ",d("voice.aiHandoff.notes")]}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.metadata.notes})]})]}),w.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-slate-900/50 border-t border-gray-200 dark:border-slate-700",children:[w.jsxs("div",{className:"flex items-center justify-center gap-4",children:[w.jsxs("button",{onClick:s,className:"flex-1 max-w-xs py-4 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-xl flex items-center justify-center gap-3 transition-all hover:scale-105 shadow-lg",children:[w.jsx(Z,{className:"w-6 h-6"}),w.jsx("span",{children:d("voice.reject")})]}),w.jsxs("button",{onClick:a,className:"flex-1 max-w-xs py-4 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-xl flex items-center justify-center gap-3 transition-all hover:scale-105 shadow-lg animate-pulse",children:[w.jsx(X,{className:"w-6 h-6"}),w.jsx("span",{className:"text-lg",children:d("voice.answer").toUpperCase()})]})]}),w.jsxs("p",{className:"text-center text-xs text-gray-500 dark:text-gray-400 mt-3",children:["â±ï¸ ",d("voice.aiHandoff.autoReject",{seconds:30-g})]})]})]})});var h},Ct=({call:t,onAccept:a,onReject:s,onDismiss:r,onExpand:l})=>{var n;const{t:i,i18n:o}=j("agent"),[d,c]=T.useState(0),[g]=T.useState(()=>new Audio("/sounds/incoming-call.mp3"));T.useEffect(()=>{const t=setInterval(()=>{c(e=>e+1)},1e3),a=setTimeout(()=>{r()},3e4);return g.loop=!0,g.play().catch(t=>e.error("Failed to play ring sound",t)),()=>{clearInterval(t),clearTimeout(a),g.pause(),g.currentTime=0}},[g,r]);return w.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[9999] animate-fade-in",children:w.jsxs("div",{className:"relative bg-white dark:bg-slate-800 rounded-xl border-2 border-blue-500 dark:border-blue-600 shadow-2xl p-4 w-96 max-w-[calc(100vw-2rem)]",children:[w.jsxs("div",{className:"absolute -top-1 -right-1 flex h-5 w-5",children:[w.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),w.jsx("span",{className:"relative inline-flex rounded-full h-5 w-5 bg-blue-500 border-2 border-white dark:border-slate-800"})]}),w.jsx("button",{onClick:r,className:"absolute top-2 right-2 p-1.5 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors","aria-label":i("voice.close"),children:w.jsx(G,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),w.jsxs("div",{className:"flex items-center gap-3 mb-3 pr-6",children:[w.jsxs("div",{className:"relative flex-shrink-0",children:[t.caller.avatar?w.jsx("img",{src:t.caller.avatar,alt:t.caller.name,className:"w-14 h-14 rounded-full border-2 border-blue-500 dark:border-blue-600"}):w.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:w.jsx(L,{className:"w-7 h-7 text-white"})}),w.jsxs("span",{className:"absolute -bottom-1 -right-1 flex h-4 w-4",children:[w.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),w.jsx("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-green-500 border-2 border-white dark:border-slate-800"})]})]}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsx("h4",{className:"font-bold text-gray-900 dark:text-white truncate text-base",children:t.caller.name}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:t.caller.phoneNumber||i("voice.internalCall")})]})]}),w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[(()=>{var e;const a=null==(e=t.metadata)?void 0:e.priority;if(!a||"normal"===a)return null;const s={urgent:{emoji:"ðŸš¨",label:i("voice.priority.urgent"),color:"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400"},high:{emoji:"âš¡",label:i("voice.priority.high"),color:"bg-orange-100 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400"},low:{emoji:"ðŸ“±",label:i("voice.priority.low"),color:"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-400"}}[a];return s?w.jsxs("span",{className:`px-2 py-1 text-xs font-semibold rounded ${s.color}`,children:[s.emoji," ",s.label]}):null})(),w.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400",children:[w.jsx($,{className:"w-4 h-4"}),w.jsx("span",{className:"font-mono font-semibold",children:(x=d,`${Math.floor(x/60)}:${(x%60).toString().padStart(2,"0")}`)})]})]}),(null==(n=t.aiHandling)?void 0:n.aiStuckReason)&&w.jsx("div",{className:"mb-3 p-2.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:w.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100 font-medium",children:["ðŸ¤– ",t.aiHandling.aiStuckReason]})}),w.jsxs("button",{onClick:l,className:"w-full mb-2 py-2 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-400 font-medium rounded-lg transition-colors flex items-center justify-center gap-2 border border-blue-200 dark:border-blue-800",children:[w.jsx(ee,{className:"w-4 h-4"}),w.jsx("span",{children:i("voice.viewDetails")})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsxs("button",{onClick:a,className:"flex-1 py-2.5 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold rounded-lg transition-all flex items-center justify-center gap-2 shadow-md hover:shadow-lg",children:[w.jsx(X,{className:"w-5 h-5"}),w.jsx("span",{children:i("voice.answer")})]}),w.jsx("button",{onClick:s,className:"px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors flex items-center justify-center",title:i("voice.reject"),children:w.jsx(Z,{className:"w-5 h-5"})})]}),w.jsx("div",{className:"mt-2 text-center",children:w.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["internal"===t.callType?`ðŸ“ž ${i("voice.internal")}`:`ðŸ“± ${i("voice.externalCall")}`," â€¢"," ",rt(new Date(t.startedAt||Date.now()),o.language,{hour:"2-digit",minute:"2-digit"})]})})]})});var x},St=({targetId:e="main-content",label:t="Ana iÃ§eriÄŸe geÃ§"})=>w.jsx("a",{href:`#${e}`,onClick:t=>{t.preventDefault();const a=document.getElementById(e);a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"start"}))},className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-[9999] focus:px-4 focus:py-2 focus:bg-orange-600 focus:text-white focus:rounded-lg focus:shadow-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-all","aria-label":t,children:t}),Tt=({call:e,mediaState:t,onToggleMute:a,onToggleSpeaker:s,onHold:r,onResume:l,onTransfer:n,onEndCall:i})=>{const{t:d,i18n:c}=j("agent"),[g,x]=T.useState(0),[m,u]=T.useState("");T.useEffect(()=>{if("connected"===e.status&&e.startedAt){const t=new Date(e.startedAt).getTime(),a=setInterval(()=>{const e=Date.now(),a=Math.floor((e-t)/1e3);x(a)},1e3);return()=>clearInterval(a)}},[e.status,e.startedAt]);const h="on_hold"===e.status;return w.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-6xl h-[90vh] flex overflow-hidden",children:[w.jsxs("div",{className:"w-1/2 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-8 flex flex-col items-center justify-between relative",children:[w.jsx("div",{className:"absolute inset-0 opacity-20",children:w.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.2),transparent_70%)] animate-pulse"})}),w.jsxs("div",{className:"relative z-10 w-full flex flex-col items-center",children:[w.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[w.jsx(te,{className:`w-5 h-5 ${(()=>{switch(t.connection.quality){case"excellent":return"text-green-600 dark:text-green-400";case"good":return"text-blue-600 dark:text-blue-400";case"fair":return"text-yellow-600 dark:text-yellow-400";case"poor":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}})()}`}),w.jsxs("span",{className:"text-sm text-gray-400",children:["excellent"===t.connection.quality?d("voice.connectionQuality.excellent"):"good"===t.connection.quality?d("voice.connectionQuality.good"):"fair"===t.connection.quality?d("voice.connectionQuality.fair"):d("voice.connectionQuality.poor")," ","(",t.connection.latency,"ms)"]})]}),w.jsxs("div",{className:"text-center mb-6",children:[e.caller.avatar?w.jsx("img",{src:e.caller.avatar,alt:e.caller.name,className:"w-24 h-24 rounded-full border-4 border-white/20 shadow-xl mx-auto mb-4"}):w.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center mx-auto mb-4 border-4 border-white/20 shadow-xl",children:w.jsx("span",{className:"text-3xl font-bold text-white",children:e.caller.name.charAt(0).toUpperCase()})}),w.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:e.caller.name}),e.caller.phoneNumber&&w.jsx("p",{className:"text-lg text-gray-400",children:e.caller.phoneNumber}),w.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 backdrop-blur-sm rounded-full mt-3",children:h?w.jsxs(w.Fragment,{children:[w.jsx(ae,{className:"w-4 h-4 text-yellow-400 animate-pulse"}),w.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:d("voice.callStatus.onHold")})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"w-2.5 h-2.5 bg-green-500 rounded-full animate-pulse"}),w.jsx("span",{className:"text-white text-sm font-medium",children:d("voice.callStatus.connected")})]})})]}),w.jsx("div",{className:"text-center mb-8",children:w.jsx("p",{className:"text-4xl font-mono font-bold text-white",children:(e=>{const t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=e%60;return t>0?`${t}:${a.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${a}:${s.toString().padStart(2,"0")}`})(g)})}),t.recording.isRecording&&w.jsxs("div",{className:"flex items-center gap-2 mb-4 px-3 py-2 bg-red-500/20 backdrop-blur-sm rounded-lg border border-red-500/50",children:[w.jsx("div",{className:"w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse"}),w.jsx("span",{className:"text-sm text-red-300 font-medium",children:d("voice.callStatus.recording")})]})]}),w.jsxs("div",{className:"relative z-10 w-full",children:[w.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[w.jsxs("button",{onClick:a,className:"p-5 rounded-xl transition-all flex flex-col items-center gap-1.5 "+(t.audio.muted?"bg-red-500 hover:bg-red-600 text-white":"bg-white/10 hover:bg-white/20 text-white backdrop-blur-sm"),children:[t.audio.muted?w.jsx(se,{className:"w-7 h-7"}):w.jsx(re,{className:"w-7 h-7"}),w.jsx("span",{className:"text-xs font-medium",children:t.audio.muted?d("voice.controls.muted"):d("voice.controls.microphone")})]}),w.jsxs("button",{onClick:h?l:r,className:"p-5 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl transition-all flex flex-col items-center gap-1.5 text-white",children:[h?w.jsx(le,{className:"w-7 h-7"}):w.jsx(ae,{className:"w-7 h-7"}),w.jsx("span",{className:"text-xs font-medium",children:d(h?"voice.controls.resume":"voice.controls.hold")})]}),w.jsxs("button",{onClick:s,className:"p-5 rounded-xl transition-all flex flex-col items-center gap-1.5 "+(t.audio.volume>0?"bg-blue-500 hover:bg-blue-600 text-white":"bg-white/10 hover:bg-white/20 text-white backdrop-blur-sm"),children:[t.audio.volume>0?w.jsx(ne,{className:"w-7 h-7"}):w.jsx(ie,{className:"w-7 h-7"}),w.jsx("span",{className:"text-xs font-medium",children:d("voice.controls.speaker")})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[w.jsxs("button",{onClick:n,className:"p-3 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl transition-all flex items-center justify-center gap-2 text-white",children:[w.jsx(oe,{className:"w-5 h-5"}),w.jsx("span",{className:"text-sm",children:d("voice.controls.transfer")})]}),w.jsxs("button",{className:"p-3 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl transition-all flex items-center justify-center gap-2 text-white",children:[w.jsx(de,{className:"w-5 h-5"}),w.jsx("span",{className:"text-sm",children:d("voice.addNote")})]})]}),w.jsxs("button",{onClick:i,className:"w-full py-4 bg-red-500 hover:bg-red-600 text-white font-bold rounded-xl transition-all flex items-center justify-center gap-2 shadow-xl",children:[w.jsx(Z,{className:"w-6 h-6"}),w.jsx("span",{children:d("voice.endCall")})]})]})]}),w.jsxs("div",{className:"w-1/2 flex flex-col bg-gray-50 dark:bg-slate-900",children:[w.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(de,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:d("voice.callDetails")}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("voice.callDetailsSubtitle")})]})]}),w.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors","aria-label":d("voice.endCall"),children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),w.jsxs("div",{className:"p-4 space-y-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx(L,{className:"w-5 h-5 text-gray-400 mt-0.5"}),w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:d("voice.customer")}),w.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.caller.name}),e.caller.phoneNumber&&w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.caller.phoneNumber})]})]}),w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx($,{className:"w-5 h-5 text-gray-400 mt-0.5"}),w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:d("voice.callStartTime")}),w.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100",children:e.startedAt?rt(new Date(e.startedAt),c.language,{hour:"2-digit",minute:"2-digit"}):"N/A"})]})]}),w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx(ce,{className:"w-5 h-5 text-gray-400 mt-0.5"}),w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:d("voice.callType")}),w.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100",children:"inbound"===e.callType?d("voice.incomingCall"):d("voice.outgoingCall")})]})]})]}),w.jsxs("div",{className:"flex-1 flex flex-col p-4 overflow-hidden",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsx("label",{htmlFor:"call-notes",className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:d("voice.callNotes")}),w.jsx("button",{onClick:()=>{o(d("voice.notesSaved"))},disabled:!m.trim(),className:"px-3 py-1.5 text-xs font-medium bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-slate-600 text-white rounded-lg transition-colors disabled:cursor-not-allowed",children:d("voice.save")})]}),w.jsx("textarea",{id:"call-notes",value:m,onChange:e=>u(e.target.value),placeholder:d("voice.callNotesPlaceholder"),className:"flex-1 w-full px-4 py-3 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-gray-100 text-sm resize-none"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:d("voice.callNotesHint")})]}),w.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border-t border-blue-200 dark:border-blue-800",children:w.jsxs("div",{className:"flex items-start gap-2",children:[w.jsx(ce,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),w.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:d("voice.phoneCallNote")})]})})]})]})})},It=({children:e})=>{const{t:t,i18n:a}=j("agent"),[s,r]=T.useState(!1),[l,n]=T.useState(!1),[o,c]=T.useState(!1),[g,x]=T.useState(null),[m,u]=T.useState(null),[h,b]=T.useState(null),[p,y]=T.useState({audio:{muted:!1,volume:80},recording:{isRecording:!1},connection:{quality:"excellent",latency:45,packetLoss:.1}}),{status:f}=nt(),{activeCall:v,acceptCall:k,rejectCall:C,dismissCall:S,isRinging:I,currentAgentName:A,triggerEmergencyCall:E}=vt(),{activeToast:M,dismissToast:R}=jt(),{user:D}=i(),F=(null==D?void 0:D.name)||"Agent",_=e=>{switch(e){case"happy":return"positive";case"angry":case"frustrated":return"negative";default:return"neutral"}},L=N.useMemo(()=>{var e,t,s,r,l,n,i,o,d;return v?{id:v.id,tenantId:(null==D?void 0:D.tenantId)||"",caller:{id:v.id,name:v.customerName,phoneNumber:v.customerPhone||"",avatar:v.customerAvatar,role:"customer"},callee:{id:"agent-current",name:F,phoneNumber:"",role:"agent"},callType:"inbound",startedAt:v.timestamp.toISOString(),status:I?"ringing":"connected",metadata:{priority:(d=v.priority,"critical"===d||"urgent"===d?"urgent":"high"===d?"high":"medium"===d?"normal":"low"===d?"low":"normal"),notes:v.reason},aiHandling:{isHandledByAI:!0,aiStuckReason:v.reason||"AI yardÄ±m istiyor",aiDuration:(null==(e=v.metadata)?void 0:e.waitingTime)||0,aiSummary:{conversationContext:v.messages.map(e=>`${e.senderName}: ${e.content}`).join("\n"),stuckReason:v.reason||"AI konuÅŸmayÄ± ilerleteemedi",customerIntent:(null==(s=null==(t=v.metadata)?void 0:t.tags)?void 0:s.join(", "))||"DetaylÄ± bilgi gerekiyor",sentiment:_(null==(r=v.metadata)?void 0:r.customerSentiment),previousInteractions:(null==(l=v.metadata)?void 0:l.aiAttempts)||0,lastInteractionDate:st(v.timestamp,a.language),quickNotes:(null==(n=v.metadata)?void 0:n.tags)||[],suggestedResponse:"MÃ¼ÅŸteri ile doÄŸrudan iletiÅŸime geÃ§in ve sorununu Ã§Ã¶zÃ¼n.",keyTopics:(null==(i=v.metadata)?void 0:i.tags)||[],customerIssues:[v.reason||"Genel destek talebi"],aiAttempts:(null==(o=v.metadata)?void 0:o.aiAttempts)||0}}}:null},[v,I,null==D?void 0:D.tenantId,F,a.language]);N.useEffect(()=>{},[v,I,L]);const B={available:{label:t("status.available"),icon:O,iconColor:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/30",textColor:"text-green-700 dark:text-green-400"},busy:{label:t("status.busy"),icon:H,iconColor:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/30",textColor:"text-red-700 dark:text-red-400"},away:{label:t("status.away"),icon:$,iconColor:"text-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",textColor:"text-yellow-700 dark:text-yellow-400"},on_break:{label:t("status.onBreak"),icon:P,iconColor:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/30",textColor:"text-orange-700 dark:text-orange-400"}},Q=B[f]||B.available,K=Q.icon;return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-slate-50 dark:bg-slate-900 transition-colors duration-200",style:{fontFamily:'Inter, "Noto Sans", sans-serif'},children:[w.jsx(St,{}),s&&w.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>r(!1)}),w.jsx("div",{className:`\n        fixed top-0 left-0 h-full w-72 z-50 transform transition-transform duration-300 lg:hidden\n        ${s?"translate-x-0":"-translate-x-full"}\n      `,children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 h-full shadow-2xl overflow-y-auto",children:[w.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-slate-700",children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"MenÃ¼"}),w.jsx("button",{onClick:()=>r(!1),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors","aria-label":t("layout.closeMenu"),children:w.jsx(G,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),w.jsx(yt,{onItemClick:()=>r(!1)})]})}),w.jsxs("div",{className:"layout-container flex h-full grow flex-col",children:[w.jsxs("div",{className:"lg:hidden sticky top-0 z-30 bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 shadow-sm",children:[w.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[w.jsx("button",{onClick:()=>r(!s),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors","aria-label":t("layout.toggleMenu"),children:w.jsx(ge,{className:"w-5 h-5 text-gray-900 dark:text-gray-100"})}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("img",{src:"/logo.svg",alt:"AsistanApp",className:"w-6 h-6"}),w.jsxs("h1",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:[F," - AsistanApp"]})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg ${Q.bgColor}`,children:[w.jsx(K,{className:`w-3.5 h-3.5 ${Q.iconColor}`}),w.jsx("span",{className:`text-xs font-semibold ${Q.textColor}`,children:Q.label})]}),!1,w.jsxs("button",{onClick:()=>c(!0),className:"relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors","aria-label":t("layout.notifications"),children:[w.jsx(z,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),w.jsx("span",{className:"absolute top-1 right-1 w-1.5 h-1.5 bg-red-500 rounded-full"})]}),w.jsx(d,{})]})]}),o&&w.jsx(ft,{onClose:()=>c(!1)})]}),w.jsxs("div",{className:"gap-1 px-2 sm:px-4 lg:px-6 flex flex-1 justify-center py-2 lg:py-5",children:[w.jsx("div",{className:"layout-content-container flex-col flex-shrink-0 hidden lg:flex",children:w.jsx(yt,{isCollapsed:l,onToggleCollapse:()=>n(!l)})}),w.jsxs("div",{className:"layout-content-container flex flex-col flex-1 min-w-0 w-full",children:[w.jsx("div",{className:"hidden lg:block",children:w.jsx(kt,{})}),w.jsx("div",{id:"main-content",className:"flex-1",tabIndex:-1,children:e})]})]})]}),v&&I&&("urgent"===v.priority||"critical"===v.priority)&&L&&w.jsx(wt,{call:L,onAccept:()=>{k(F)},onReject:()=>{C("Agent meÅŸgul")},takenByOtherAgent:(null==v?void 0:v.takenBy)&&v.takenBy.agentName!==F?{name:v.takenBy.agentName,timestamp:v.takenBy.takenAt}:void 0}),v&&!h&&I&&("high"===v.priority||"medium"===v.priority||"low"===v.priority)&&L&&w.jsx(Ct,{call:L,onAccept:()=>{k(F)},onReject:()=>{C("Agent meÅŸgul")},onDismiss:()=>{S()},onExpand:()=>{b(v)}}),h&&I&&("high"===h.priority||"medium"===h.priority||"low"===h.priority)&&L&&w.jsx(wt,{call:L,onAccept:()=>{k(F),b(null)},onReject:()=>{C("Agent meÅŸgul"),b(null)}}),g&&!m&&!v&&w.jsx(wt,{call:g,onAccept:()=>{u(g),x(null)},onReject:()=>{x(null)}}),m&&w.jsx(Tt,{call:m,mediaState:p,onToggleMute:()=>{y(e=>({...e,audio:{...e.audio,muted:!e.audio.muted}}))},onToggleSpeaker:()=>{y(e=>({...e,audio:{...e.audio,volume:e.audio.volume>0?0:80}}))},onHold:()=>{u({...m,status:"on_hold"})},onResume:()=>{u({...m,status:"connected"})},onTransfer:()=>{},onEndCall:()=>{u(null)}}),M&&w.jsx(Nt,{channelId:M.channelId,messageId:M.messageId,channelName:M.channelName,mentionedBy:M.mentionedBy,message:M.message,onDismiss:R})]})},At="urgent",Et="high",Mt="medium",Rt="low",Dt={[At]:4,[Et]:3,[Mt]:2,[Rt]:1},Ft={[At]:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",[Et]:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",[Mt]:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",[Rt]:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},_t="whatsapp",Lt="instagram",Ot="facebook",Ht="web",$t="phone",Pt="email",Bt="telegram",Qt={[_t]:"ðŸ’¬",[Lt]:"ðŸ“·",[Ot]:"ðŸ‘¥",[Ht]:"ðŸŒ",[$t]:"ðŸ“ž",[Pt]:"ðŸ“§",[Bt]:"âœˆï¸"},zt={[_t]:"bg-green-100 dark:bg-green-900/30",[Lt]:"bg-pink-100 dark:bg-pink-900/30",[Ot]:"bg-indigo-100 dark:bg-indigo-900/30",[Ht]:"bg-blue-100 dark:bg-blue-900/30",[$t]:"bg-orange-100 dark:bg-orange-900/30",[Pt]:"bg-purple-100 dark:bg-purple-900/30",[Bt]:"bg-sky-100 dark:bg-sky-900/30"},Gt=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var e,t,a,s,r,l,n;const{t:o,i18n:d}=j("agent"),{user:g}=i(),x=new Date((new Date).setHours(0,0,0,0)).toISOString(),m=new Date((new Date).setHours(23,59,59,999)).toISOString(),{data:u,isLoading:h}=y(et.my(),()=>mt(),{select:e=>e.data,staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1}),b=u,{data:p,isLoading:f,refetch:v}=(k=(null==g?void 0:g.id)||"",N={from:x,to:m},y(et.metrics(k,N),()=>ht(k,N),{select:e=>e.data,enabled:!!k,staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1}));var k,N;const S=p,{data:I,isLoading:A}=pt({status:"assigned",assignedTo:null==g?void 0:g.id,limit:10}),E=I||[],M=h||f||A,R=Qt,F=Ft,_=T.useMemo(()=>[...E].sort((e,t)=>{const a=(Dt[t.priority]||1)-(Dt[e.priority]||1);if(0!==a)return a;const s=new Date(e.lastMessageTime||e.updatedAt||0).getTime();return new Date(t.lastMessageTime||t.updatedAt||0).getTime()-s}),[E]),L={resolved:(null==(e=null==S?void 0:S.conversations)?void 0:e.resolved)||0,pending:(null==(t=null==b?void 0:b.stats)?void 0:t.activeConversations)||0,avgResponseTime:(e=>{if(!e)return`0 ${o("common:units.minutes")}`;return`${Math.round(e/60)} ${o("common:units.minutes")}`})(null==(a=null==S?void 0:S.performance)?void 0:a.averageResponseTime),satisfaction:(e=>{const t=e?e.toFixed(1):"0.0";return o("dashboard.satisfactionScore",{score:t,max:"5"})})(null==(s=null==S?void 0:S.performance)?void 0:s.satisfactionScore)},H=E.filter(e=>e.unreadCount&&e.unreadCount>0).length;return M?w.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:w.jsx(c,{})}):w.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[w.jsxs("div",{className:"flex items-start justify-between",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:o("dashboard.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o("dashboard.welcomeWithName",{name:(null==b?void 0:b.name)||(null==g?void 0:g.name)||"Agent"})})]}),w.jsx("button",{type:"button",onClick:()=>v(),className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:o("common:common.refresh"),children:w.jsx(xe,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:w.jsx(O,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:o("dashboard.today")})]}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:L.resolved}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o("dashboard.resolvedConversations")}),(null==(r=null==S?void 0:S.conversations)?void 0:r.total)?w.jsxs("div",{className:"mt-3 flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[w.jsx(me,{className:"w-3 h-3"}),w.jsx("span",{children:o("dashboard.resolutionRate",{rate:Math.round(L.resolved/S.conversations.total*100)})})]}):w.jsx("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:o("dashboard.greatJob")})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:w.jsx(q,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:o("dashboard.now")})]}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:L.pending}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o("dashboard.pendingConversations")}),w.jsx(C,{to:"/agent/conversations",className:"mt-3 text-xs text-orange-600 dark:text-orange-400 hover:underline inline-block",children:o("dashboard.replyNow")})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:w.jsx($,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:o("common:labels.average")})]}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:L.avgResponseTime}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o("dashboard.responseTime")}),w.jsx("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:o("dashboard.targetResponseTime")})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:w.jsx(D,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:o("dashboard.satisfaction")})]}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:L.satisfaction}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o("dashboard.customerScore")}),w.jsx("div",{className:"mt-3 text-xs text-green-600 dark:text-green-400",children:(null==(l=null==S?void 0:S.performance)?void 0:l.satisfactionScore)&&S.performance.satisfactionScore>=4.5?o("dashboard.feedback.excellent"):(null==(n=null==S?void 0:S.performance)?void 0:n.satisfactionScore)&&S.performance.satisfactionScore>=4?o("dashboard.feedback.good"):o("dashboard.feedback.keepGoing")})]})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700",children:[w.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:o("dashboard.pendingConversationsList")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:H>0?o("dashboard.newMessages",{count:H}):o("dashboard.allMessagesRead")})]}),w.jsx(C,{to:"/agent/conversations",className:"px-4 py-2 bg-orange-500 text-white text-sm font-medium rounded-lg hover:bg-orange-600 transition-colors",children:o("common:labels.viewAll")})]})}),0===_.length?w.jsxs("div",{className:"p-12 text-center",children:[w.jsx(D,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:o("dashboard.noAssignedConversations")}),w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:o("dashboard.autoAssignMessage")})]}):w.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:_.slice(0,10).map(e=>{return w.jsx(C,{to:`/agent/conversations?openConversation=${e.id}`,className:"block p-6 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:w.jsxs("div",{className:"flex items-start justify-between gap-4",children:[w.jsxs("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[w.jsx("div",{className:"text-3xl flex-shrink-0",children:R[e.channel]||"ðŸ’¬"}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.customerName}),w.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${F[e.priority]||F.medium}`,children:(t=e.priority,o(`priority.${t}`,{defaultValue:t}))})]}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.lastMessage}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:e.lastMessageTime?Ve(new Date(e.lastMessageTime),{addSuffix:!0,locale:"tr"===d.language?We:void 0}):o("dashboard.justNow")})]})]}),e.unreadCount&&e.unreadCount>0&&w.jsx("div",{className:"flex-shrink-0",children:w.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-orange-500 text-white text-xs font-bold rounded-full",children:e.unreadCount})})]})},e.id);var t})})]})]})}},Symbol.toStringTag,{value:"Module"})),Kt=zt,Ut=Qt,qt=T.memo(({customerName:e,channel:t,isFullscreen:a,isMobile:s,canSendMessage:r,isAssignedToCurrentUser:l,isLocked:n,status:i,onClose:o,onBack:d,onToggleFullscreen:c,onToggleNotes:g,onToggleTags:x,onResolve:m,onTakeOver:u})=>{const{t:h}=j("agent");return w.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 flex items-center justify-between bg-white dark:bg-slate-800",children:[w.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a?w.jsx("button",{onClick:o,className:"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors","aria-label":h("conversations.header.close"),title:h("conversations.header.closeEsc"),children:w.jsx(G,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}):w.jsx("button",{onClick:d,className:"lg:hidden p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors","aria-label":h("conversations.header.back"),children:w.jsx(B,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[w.jsx("div",{className:`w-10 h-10 rounded-full ${Kt[t]} flex items-center justify-center text-xl flex-shrink-0`,children:Ut[t]}),w.jsxs("div",{className:"min-w-0 flex-1",children:[w.jsxs("h2",{className:"font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2 truncate",children:[e,w.jsx("button",{onClick:g,className:"p-1 hover:bg-gray-100 dark:hover:bg-slate-700 rounded transition-colors flex-shrink-0",title:h("conversations.header.addNote"),children:w.jsx(de,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:t})]})]})]}),w.jsxs("div",{className:"flex items-center gap-2 ml-4 flex-shrink-0",children:[w.jsx("button",{onClick:c,className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:h(a?"conversations.header.exitFullscreen":"conversations.header.fullscreen"),"aria-label":h(a?"conversations.header.exitFullscreen":"conversations.header.fullscreen"),children:a?w.jsx(ue,{className:"w-5 h-5"}):w.jsx(ee,{className:"w-5 h-5"})}),w.jsxs("button",{onClick:x,className:"hidden sm:flex px-3 py-2 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors items-center gap-2",title:h("conversations.header.tags"),children:[w.jsx(he,{className:"w-4 h-4"}),w.jsx("span",{className:"hidden sm:inline",children:h("conversations.header.tags")})]}),!l&&!n&&w.jsxs("button",{onClick:u,className:"px-4 py-2 bg-orange-500 text-white text-sm font-medium rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",title:h("conversations.header.takeOver"),children:[w.jsx(be,{className:"w-4 h-4"}),w.jsx("span",{className:"hidden sm:inline",children:h("conversations.header.takeOver")})]}),l&&"resolved"!==i&&w.jsxs("button",{onClick:m,className:"px-4 py-2 bg-green-500 text-white text-sm font-medium rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",title:h("conversations.header.resolve"),children:[w.jsx(O,{className:"w-4 h-4"}),w.jsx("span",{className:"hidden sm:inline",children:h("conversations.header.resolve")})]})]})]})});qt.displayName="ConversationHeader";const Vt=zt,Wt=Qt,Jt=Ft,Yt={happy:"ðŸ˜Š",neutral:"ðŸ˜",angry:"ðŸ˜ ",sad:"ðŸ˜¢"},Zt=T.memo(({conversations:e,selectedConversation:t,currentUserId:a,onSelect:s,onTakeOver:r,onAssign:l,isLoading:n=!1})=>{const{t:i}=j("agent"),o=T.useMemo(()=>0===e.length,[e.length]);return n?w.jsx("div",{className:"flex-1 overflow-y-auto",children:w.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[w.jsx("div",{className:"flex items-center justify-center gap-1 mb-4",children:[0,1,2].map(e=>w.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:i("conversations.loading")})]})}):o?w.jsx("div",{className:"flex-1 overflow-y-auto",children:w.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[w.jsx(D,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:i("conversations.noConversations")})]})}):w.jsx("div",{className:"flex-1 overflow-y-auto",children:w.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:e.map(e=>{const r=(null==t?void 0:t.id)===e.id,n=e.assignedTo===a;return w.jsx("button",{onClick:()=>s(e),className:"w-full p-4 text-left hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors "+(r?"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-500":""),children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx("div",{className:`w-12 h-12 rounded-full ${Vt[e.channel]} flex items-center justify-center text-2xl flex-shrink-0`,children:Wt[e.channel]}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[w.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:[e.customerName,e.sentiment&&w.jsx("span",{className:"ml-2 text-sm",title:e.sentiment,children:Yt[e.sentiment]})]}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:e.lastMessageTime})]}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate mb-2",children:e.lastMessage}),w.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[w.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Jt[e.priority]}`,children:["high"===e.priority&&"ðŸ”¥ "+i("conversations.list.urgentPriority"),"medium"===e.priority&&"âš ï¸ "+i("conversations.list.highPriority"),"low"===e.priority&&"ðŸ“‹ "+i("conversations.list.lowPriority")]}),e.isLocked&&w.jsxs("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full flex items-center gap-1",children:[w.jsx(pe,{className:"w-3 h-3"}),e.lockedBy]}),e.aiStuck&&w.jsxs("span",{className:"text-xs px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-full font-bold flex items-center gap-1 animate-pulse",children:[w.jsx(_,{className:"w-3 h-3"}),i("conversations.list.aiStuck")]}),e.unreadCount>0&&w.jsx("span",{className:"text-xs px-2 py-0.5 bg-orange-500 text-white rounded-full font-bold",children:e.unreadCount}),!n&&"waiting"===e.status&&w.jsx("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"text-xs px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded-full hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors",children:i("conversations.list.forward")})]})]})]})},e.id)})})})});Zt.displayName="ConversationList";const Xt=T.memo(({messages:e,isCustomerTyping:t,copiedMessageId:a,onCopyMessage:s,agentName:r="Agent"})=>{const{t:l,i18n:n}=j("agent"),i=T.useRef(null);T.useEffect(()=>{var e;null==(e=i.current)||e.scrollIntoView({behavior:"smooth"})},[e.length]);const o=e=>rt("string"==typeof e?new Date(e):e,n.language,{hour:"2-digit",minute:"2-digit"});return w.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.map(e=>"system"===e.sender?w.jsx("div",{className:"flex justify-center my-4",children:w.jsxs("div",{className:"max-w-md w-full bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-800 dark:text-blue-300",children:[w.jsx(ce,{className:"w-4 h-4 flex-shrink-0"}),w.jsx("span",{children:e.text})]}),w.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1 ml-6",children:o(e.timestamp)})]})},e.id):"customer"===e.sender?w.jsxs("div",{className:"flex items-start gap-2",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:w.jsx(L,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsxs("div",{className:"flex-1 max-w-[70%]",children:[w.jsx("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-slate-600",children:w.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-words",children:e.text})}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:o(e.timestamp)})]})]},e.id):"ai"===e.sender?w.jsxs("div",{className:"flex items-start gap-2",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center flex-shrink-0",children:w.jsx(_,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),w.jsxs("div",{className:"flex-1 max-w-[70%]",children:[w.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-3",children:[w.jsx("div",{className:"flex items-center gap-2 mb-1",children:w.jsx("span",{className:"text-xs font-semibold text-purple-600 dark:text-purple-400",children:l("conversations.messageArea.aiAssistant")})}),w.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-words",children:e.text})]}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:o(e.timestamp)})]})]},e.id):"agent"===e.sender?w.jsxs("div",{className:"flex items-start gap-2 justify-end",children:[w.jsxs("div",{className:"flex-1 max-w-[70%] flex flex-col items-end",children:[w.jsx("div",{className:"bg-orange-500 text-white rounded-lg p-3 shadow-sm",children:w.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:e.text})}),w.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[w.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.agentName||r," â€¢ ",o(e.timestamp)]}),w.jsx("button",{onClick:()=>s(e.id,e.text),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:l("common.copyMessage"),"aria-label":l("common.copyMessage"),children:a===e.id?w.jsx(K,{className:"w-3 h-3 text-green-500"}):w.jsx(ye,{className:"w-3 h-3"})})]})]}),w.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center flex-shrink-0",children:w.jsx(L,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})})]},e.id):null),t&&w.jsxs("div",{className:"flex items-start gap-2",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:w.jsx(L,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsxs("div",{className:"flex-1 max-w-[70%]",children:[w.jsx("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-slate-600",children:w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l("conversations.messageArea.typing")})]})]}),w.jsx("div",{ref:i})]})});function ea(e){return!0===e}Xt.displayName="MessageArea";const ta=T.memo(({messageInput:e,attachedFiles:t,showEmojiPicker:a,canSendMessage:s,isLocked:r,lockedBy:l,onMessageChange:n,onSendMessage:i,onAddFiles:o,onRemoveFile:d,onToggleEmojiPicker:c,onEmojiSelect:g,onToggleQuickReplies:x,onToggleNotes:m,isUploading:u=!1})=>{const{t:h}=j("agent"),b=T.useRef(null),p=T.useRef(null),y=T.useRef(null),[f,v]=T.useState(!1),k=T.useCallback(e=>{const t=Array.from(e.target.files||[]);t.length>0&&o(t),e.target.value="",v(!1)},[o]),N=T.useCallback(a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),(e.trim()||t.length>0)&&i())},[e,t.length,i]),C=T.useCallback(e=>{g(e.emoji)},[g]);return s?w.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-900",children:[w.jsxs("div",{className:"flex items-end gap-2",children:[w.jsx("button",{onClick:x,className:"p-2 text-gray-600 dark:text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors flex-shrink-0",title:h("conversations.messageInput.quickReplies"),"aria-label":h("conversations.messageInput.quickReplies"),children:w.jsx(fe,{className:"w-5 h-5"})}),w.jsx("button",{onClick:m,className:"p-2 text-gray-600 dark:text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors flex-shrink-0",title:h("conversations.messageInput.notes"),"aria-label":h("conversations.messageInput.notes"),children:w.jsx(de,{className:"w-5 h-5"})}),w.jsxs("div",{className:"relative flex-shrink-0",children:[w.jsx("button",{onClick:()=>v(!f),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:h("conversations.messageInput.addFile"),"aria-label":h("conversations.messageInput.addFile"),children:w.jsx(ve,{className:"w-5 h-5"})}),f&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>v(!1)}),w.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-600 rounded-lg shadow-xl z-20 py-2 min-w-[160px]",children:[w.jsxs("button",{onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-slate-700 flex items-center gap-3 text-sm text-gray-700 dark:text-gray-300",children:[w.jsx(je,{className:"w-4 h-4"}),h("conversations.messageInput.file")]}),w.jsxs("button",{onClick:()=>{var e;return null==(e=p.current)?void 0:e.click()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-slate-700 flex items-center gap-3 text-sm text-gray-700 dark:text-gray-300",children:[w.jsx(ke,{className:"w-4 h-4"}),h("conversations.messageInput.photoVideo")]})]})]}),w.jsx("input",{ref:b,type:"file",className:"hidden",multiple:!0,onChange:k}),w.jsx("input",{ref:p,type:"file",accept:"image/*,video/*",className:"hidden",multiple:!0,onChange:k})]}),w.jsxs("div",{className:"relative flex-shrink-0",children:[w.jsx("button",{onClick:c,className:"p-2 text-gray-600 dark:text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:h("conversations.messageInput.addEmoji"),"aria-label":h("conversations.messageInput.addEmoji"),children:w.jsx(Ne,{className:"w-5 h-5"})}),ea(a)&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-10",onClick:c}),w.jsx("div",{className:"absolute bottom-full left-0 mb-2 z-20",children:w.jsx(Je,{onEmojiClick:C})})]})]}),t.length>0&&w.jsx("div",{className:"flex-1 px-3 py-2 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg max-w-md",children:w.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.map((e,t)=>w.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-600 rounded-lg text-sm",children:[w.jsx(ve,{className:"w-3 h-3 text-gray-500 dark:text-gray-400"}),w.jsx("span",{className:"text-gray-700 dark:text-gray-300 truncate max-w-[120px]",children:e.name}),w.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",(e.size/1024).toFixed(1)," KB)"]}),w.jsx("button",{onClick:()=>d(t),className:"ml-1 text-red-500 hover:text-red-600 transition-colors",title:h("conversations.messageInput.removeFile"),"aria-label":h("conversations.messageInput.removeFile"),children:w.jsx(G,{className:"w-3 h-3"})})]},t))})}),w.jsx("textarea",{ref:y,value:e,onChange:e=>n(e.target.value),onKeyDown:N,placeholder:h("conversations.messageInput.placeholder"),className:"flex-1 px-4 py-2.5 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 text-gray-900 dark:text-gray-100 resize-none",rows:1,style:{minHeight:"42px",maxHeight:"120px"}}),w.jsxs("button",{onClick:i,disabled:!e.trim()&&0===t.length,className:"px-6 py-2.5 bg-orange-500 text-white font-medium rounded-lg hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 flex-shrink-0",title:h("conversations.messageInput.sendMessage"),"aria-label":h("conversations.messageInput.sendMessage"),children:[w.jsx(we,{className:"w-4 h-4"}),w.jsx("span",{className:"hidden sm:inline",children:h("messages.send")})]})]}),u&&w.jsxs("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[w.jsx("div",{className:"flex items-center justify-center gap-0.5",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-orange-500 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}),h("conversations.messageInput.uploading")]})]}):w.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-900",children:w.jsxs("div",{className:"text-center py-4",children:[w.jsx("div",{className:"w-8 h-8 text-gray-400 dark:text-gray-600 mx-auto mb-2",children:"ðŸ”’"}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r&&l?h("conversations.messageInput.lockedBy",{name:l}):h("conversations.messageInput.mustTakeOver")}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:h("conversations.messageInput.cannotSend")})]})})});ta.displayName="MessageInput";const aa=({onSelect:e,onClose:t})=>{const{t:a}=j("agent"),[s,r]=T.useState(""),[l,n]=T.useState("all"),i=[{id:"all",label:a("quickReplies.categories.all")},{id:"greeting",label:a("quickReplies.categories.greeting")},{id:"order",label:a("quickReplies.categories.order")},{id:"return",label:a("quickReplies.categories.return")},{id:"product",label:a("quickReplies.categories.product")},{id:"shipping",label:a("quickReplies.categories.shipping")},{id:"general",label:a("quickReplies.categories.general")},{id:"closing",label:a("quickReplies.categories.closing")}],o=[].filter(e=>{var t;const a=e.title.toLowerCase().includes(s.toLowerCase())||e.content.toLowerCase().includes(s.toLowerCase())||(null==(t=e.shortcut)?void 0:t.toLowerCase().includes(s.toLowerCase())),r="all"===l||e.category===l;return a&&r});return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-3xl max-h-[80vh] flex flex-col",children:[w.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:w.jsx(fe,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:a("quickReplies.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("quickReplies.templateCount",{count:o.length})})]})]}),w.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),w.jsxs("div",{className:"relative",children:[w.jsx(Ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),w.jsx("input",{type:"text",placeholder:a("quickReplies.searchPlaceholder"),value:s,onChange:e=>r(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 text-gray-900 dark:text-gray-100",autoFocus:!0})]}),w.jsx("div",{className:"mt-4 flex items-center gap-2 overflow-x-auto pb-2",children:i.map(e=>w.jsx("button",{onClick:()=>n(e.id),className:"px-3 py-1.5 text-sm font-medium rounded-lg whitespace-nowrap transition-colors "+(l===e.id?"bg-orange-500 text-white":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:e.label},e.id))})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:0===o.length?w.jsxs("div",{className:"text-center py-12",children:[w.jsx(fe,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("quickReplies.noTemplates")})]}):w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(a=>w.jsxs("button",{onClick:()=>{e(a.content),t()},className:"text-left p-4 bg-gray-50 dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 hover:border-orange-500 dark:hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors group",children:[w.jsxs("div",{className:"flex items-start justify-between mb-2",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 group-hover:text-orange-600 dark:group-hover:text-orange-400",children:a.title}),a.shortcut&&w.jsx("span",{className:"text-xs px-2 py-1 bg-gray-200 dark:bg-slate-700 text-gray-600 dark:text-gray-400 rounded font-mono",children:a.shortcut})]}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:a.content})]},a.id))})}),w.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-900",children:w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:a("quickReplies.shortcutHint")})})]})})},sa=({conversationId:t,currentTags:a=[],onClose:s})=>{const{t:r}=j("agent"),[l,n]=T.useState(a||[]),[i,d]=T.useState(""),c=[{id:"urgent",label:r("tags.predefined.urgent"),color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"},{id:"vip",label:r("tags.predefined.vip"),color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},{id:"complaint",label:r("tags.predefined.complaint"),color:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"},{id:"refund",label:r("tags.predefined.refund"),color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},{id:"technical",label:r("tags.predefined.technical"),color:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400"},{id:"billing",label:r("tags.predefined.billing"),color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},{id:"feedback",label:r("tags.predefined.feedback"),color:"bg-teal-100 text-teal-700 dark:bg-teal-900/30 dark:text-teal-400"},{id:"followup",label:r("tags.predefined.followup"),color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}],x=e=>{l.includes(e)?n(l.filter(t=>t!==e)):n([...l,e])},m=()=>{i.trim()&&!l.includes(i.trim())&&(n([...l,i.trim()]),d(""))};return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-lg",children:[w.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:w.jsx(he,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:r("tags.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("tags.subtitle")})]})]}),w.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),w.jsxs("div",{className:"p-6 space-y-6",children:[l.length>0&&w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:r("tags.selectedTags",{count:l.length})}),w.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(e=>{const t=c.find(t=>t.id===e);return w.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${(null==t?void 0:t.color)||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:[(null==t?void 0:t.label)||e,w.jsx("button",{onClick:()=>x(e),className:"hover:opacity-70",children:w.jsx(G,{className:"w-3 h-3"})})]},e)})})]}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:r("tags.availableTags")}),w.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(e=>w.jsx("button",{onClick:()=>x(e.id),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-all "+(l.includes(e.id)?e.color+" ring-2 ring-offset-2 ring-current":"bg-gray-100 text-gray-700 dark:bg-slate-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:e.label},e.id))})]}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:r("tags.customTagAdd")}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"text",value:i,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),m())},placeholder:r("tags.tagNamePlaceholder"),className:"flex-1 px-3 py-2 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-gray-900 dark:text-gray-100 text-sm"}),w.jsxs("button",{onClick:m,disabled:!i.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[w.jsx(Se,{className:"w-4 h-4"}),r("common.add")]})]})]})]}),w.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-slate-700 flex items-center justify-end gap-3",children:[w.jsx("button",{onClick:s,className:"px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:r("common.cancel")}),w.jsx("button",{onClick:async()=>{try{e.debug("Saving tags",{conversationId:t,selectedTags:l}),o(r("tags.saveSuccess",{count:l.length})),s()}catch(a){g(r("tags.saveError")),e.error("Failed to save tags",a)}},className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:r("common.save")})]})]})})},ra=({onClose:e,onApply:t})=>{var a,s;const{t:r}=j("agent"),[l,n]=T.useState({channels:[],tags:[],dateRange:null,assignedTo:[],priority:[]}),i=(e,t)=>{const a=l[e];a.includes(t)?n({...l,[e]:a.filter(e=>e!==t)}):n({...l,[e]:[...a,t]})},o=l.channels.length+l.tags.length+l.assignedTo.length+l.priority.length+(l.dateRange?1:0);return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[w.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:w.jsx(Te,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:r("conversations.filters.advancedFilters")}),o>0&&w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("conversations.filters.activeFiltersCount",{count:o})})]})]}),w.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),w.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx("span",{className:"text-lg",children:"ðŸ“±"}),r("conversations.filters.channels")]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:["whatsapp","instagram","telegram","web"].map(e=>w.jsx("button",{onClick:()=>i("channels",e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all capitalize "+(l.channels.includes(e)?"bg-purple-500 text-white ring-2 ring-purple-500 ring-offset-2":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:e},e))})]}),w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(he,{className:"w-4 h-4"}),r("conversations.filters.tags")]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:["urgent","vip","complaint","refund","technical","billing"].map(e=>w.jsx("button",{onClick:()=>i("tags",e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all capitalize "+(l.tags.includes(e)?"bg-purple-500 text-white ring-2 ring-purple-500 ring-offset-2":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:e},e))})]}),w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx("span",{className:"text-lg",children:"âš¡"}),r("conversations.filters.priority")]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:["high","medium","low"].map(e=>w.jsx("button",{onClick:()=>i("priority",e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all capitalize "+(l.priority.includes(e)?"bg-purple-500 text-white ring-2 ring-purple-500 ring-offset-2":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:r("high"===e?"priority.high":"medium"===e?"priority.normal":"priority.low")},e))})]}),w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(L,{className:"w-4 h-4"}),r("conversations.filters.assignedTo")]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:[].map(e=>w.jsx("button",{onClick:()=>i("assignedTo",e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+(l.assignedTo.includes(e)?"bg-purple-500 text-white ring-2 ring-purple-500 ring-offset-2":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),children:e},e))})]}),w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(Ie,{className:"w-4 h-4"}),r("conversations.filters.dateRange")]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"date-start",className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:r("conversations.filters.startDate")}),w.jsx("input",{id:"date-start",type:"date",value:(null==(a=l.dateRange)?void 0:a.start)||"",onChange:e=>{var t;return n({...l,dateRange:{start:e.target.value,end:(null==(t=l.dateRange)?void 0:t.end)||""}})},className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 text-gray-900 dark:text-gray-100 text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"date-end",className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:r("conversations.filters.endDate")}),w.jsx("input",{id:"date-end",type:"date",value:(null==(s=l.dateRange)?void 0:s.end)||"",onChange:e=>{var t;return n({...l,dateRange:{start:(null==(t=l.dateRange)?void 0:t.start)||"",end:e.target.value}})},className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 text-gray-900 dark:text-gray-100 text-sm"})]})]})]})]}),w.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-slate-700 flex items-center justify-between",children:[w.jsx("button",{onClick:()=>{n({channels:[],tags:[],dateRange:null,assignedTo:[],priority:[]})},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:r("common.reset")}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:r("common.cancel")}),w.jsx("button",{onClick:()=>{t(l),e()},className:"px-6 py-2 bg-purple-500 text-white rounded-lg text-sm font-medium hover:bg-purple-600 transition-colors",children:r("common.apply")})]})]})]})})},la=({conversationId:e,currentAssignee:t,onClose:a,onAssign:s})=>{const{t:r}=j("agent"),[l,n]=T.useState(null),[i,o]=T.useState(""),d={online:"conversations.assignment.statusOnline",busy:"conversations.assignment.statusBusy",offline:"conversations.assignment.statusOffline"},c={online:{color:"bg-green-500"},busy:{color:"bg-yellow-500"},offline:{color:"bg-gray-500"}};return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:w.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"assignment-modal-title",className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-lg",children:[w.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:w.jsx(U,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),w.jsxs("div",{children:[w.jsx("h2",{id:"assignment-modal-title",className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:r("conversations.assignment.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("conversations.assignment.subtitle")})]})]}),w.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),w.jsxs("div",{className:"p-6 space-y-4",children:[w.jsxs("div",{children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(oe,{className:"w-4 h-4"}),r("conversations.assignment.selectAgent")]}),w.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[].map(e=>w.jsx("button",{onClick:()=>n(e.id),disabled:"offline"===e.status,className:`w-full p-3 rounded-lg border-2 transition-all text-left ${l===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-slate-700 hover:border-gray-300 dark:hover:border-slate-600"} ${"offline"===e.status?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:e.name.split(" ").map(e=>e[0]).join("")}),w.jsxs("div",{children:[w.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:[e.name,t===e.name&&w.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400",children:r("conversations.assignment.currentAssignee")})]}),w.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx("div",{className:`w-2 h-2 rounded-full ${c[e.status].color}`}),w.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:r(d[e.status])})]}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:"â€¢"}),w.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.activeConversations," ",r("conversations.filters.activeConversations")]})]})]})]}),l===e.id&&w.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center",children:w.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})},e.id))})]}),l&&w.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-slate-700",children:[w.jsx("label",{htmlFor:"assignment-reason",className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:r("conversations.assignment.reasonLabel")}),w.jsx("textarea",{id:"assignment-reason",value:i,onChange:e=>o(e.target.value),placeholder:r("conversations.assignment.notePlaceholder"),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r("conversations.assignment.reasonWillBeShown")})]})]}),w.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-slate-700 flex items-center justify-end gap-3",children:[w.jsx("button",{onClick:a,className:"px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:r("common.cancel")}),w.jsx("button",{onClick:()=>{l&&(s(l,"manual",i.trim()||void 0),a())},disabled:!l,className:"px-6 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("common.forward")})]})]})})},na=({onClose:e})=>{const{t:t}=j("agent"),a=(e=>[{category:e("keyboard.categories.general"),shortcuts:[{keys:"Ctrl+K",description:e("keyboard.focusSearch")},{keys:"Esc",description:e("keyboard.closeModals")},{keys:"?",description:e("keyboard.showShortcuts")}]},{category:e("keyboard.categories.conversations"),shortcuts:[{keys:"Ctrl+Enter",description:e("keyboard.sendMessage")},{keys:"Ctrl+N",description:e("keyboard.nextConversation")},{keys:"Ctrl+P",description:e("keyboard.previousConversation")},{keys:"Ctrl+R",description:e("keyboard.resolveConversation")},{keys:"Ctrl+T",description:e("keyboard.transfer")}]},{category:e("keyboard.categories.quickActions"),shortcuts:[{keys:"/",description:e("keyboard.quickReplies")},{keys:"Ctrl+Shift+T",description:e("keyboard.addTags")}]}])(t);return w.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fadeIn",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col animate-slideUp",children:[w.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-slate-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-purple-500 to-blue-600 flex items-center justify-center",children:w.jsx(Ae,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:t("keyboard.help.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("keyboard.help.subtitle")})]})]}),w.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors","aria-label":t("common.close"),children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),w.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:w.jsx("div",{className:"space-y-8",children:a.map(e=>w.jsxs("div",{children:[w.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[w.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-purple-500 to-blue-600 rounded-full"}),e.category]}),w.jsx("div",{className:"space-y-3",children:e.shortcuts.map((e,t)=>{return w.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-slate-900 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:[w.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.description}),w.jsx("div",{className:"flex items-center gap-1",children:(a=e.keys,a.split("+").map((e,t)=>w.jsxs(N.Fragment,{children:[t>0&&w.jsx("span",{className:"mx-1 text-gray-400",children:"+"}),w.jsx("kbd",{className:"px-2 py-1 bg-gray-100 dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded text-sm font-mono text-gray-900 dark:text-gray-100",children:e})]},t)))})]},t);var a})})]},e.category))})}),w.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-slate-700 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20",children:w.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[w.jsx(Ee,{className:"w-4 h-4"}),w.jsxs("span",{children:[w.jsx("strong",{children:t("keyboard.help.tipPrefix")})," ",t("keyboard.help.tipText")]})]})})]})})},ia=({customerId:e,customerName:t,customerEmail:a,customerPhone:s,onClose:r})=>{const{t:l,i18n:n}=j("agent"),[i,o]=T.useState("conversations"),d={joinDate:new Date,location:"N/A",totalOrders:0,lifetimeValue:0,lastSeen:new Date,tags:[]},c=[],g=[],x=[],m=e=>{o(i===e?"":e)},u=e=>new Intl.DateTimeFormat("tr-TR",{day:"2-digit",month:"short",year:"numeric"}).format(e);return w.jsxs("div",{className:"fixed inset-y-0 right-0 w-96 bg-white dark:bg-slate-800 shadow-2xl z-40 flex flex-col border-l border-gray-200 dark:border-slate-700 animate-slideIn",children:[w.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20",children:[w.jsxs("div",{className:"flex items-start justify-between mb-3",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-lg font-bold shadow-lg",children:t.charAt(0).toUpperCase()}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:t}),w.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[l("conversations.customerHistory.customerId")," ",e]})]})]}),w.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-slate-700/50 transition-colors","aria-label":l("common.close"),children:w.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),w.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-2 text-center",children:[w.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l("conversations.customerHistory.orders")}),w.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:d.totalOrders})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-2 text-center",children:[w.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l("conversations.customerHistory.total")}),w.jsx("p",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:lt(d.lifetimeValue,n.language)})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-2 text-center",children:[w.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l("conversations.customerHistory.lastSeen")}),w.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:(e=>{const t=Math.floor((Date.now()-e.getTime())/36e5);if(t<24)return l("conversations.customerHistory.timeAgo.hoursAgo",{count:t});const a=Math.floor(t/24);if(a<30)return l("conversations.customerHistory.timeAgo.daysAgo",{count:a});const s=Math.floor(a/30);return l("conversations.customerHistory.timeAgo.monthsAgo",{count:s})})(d.lastSeen)})]})]})]}),w.jsxs("div",{className:"flex-1 overflow-y-auto",children:[w.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(L,{className:"w-4 h-4 text-orange-500"}),l("conversations.customerHistory.contactInfo")]}),w.jsxs("div",{className:"space-y-2",children:[a&&w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx(Me,{className:"w-4 h-4 text-gray-400"}),w.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:a})]}),s&&w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx(X,{className:"w-4 h-4 text-gray-400"}),w.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s})]}),w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx(Re,{className:"w-4 h-4 text-gray-400"}),w.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:d.location})]}),w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx(Ie,{className:"w-4 h-4 text-gray-400"}),w.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[l("conversations.customerHistory.member")," ",u(d.joinDate)]})]})]})]}),w.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[w.jsx(he,{className:"w-4 h-4 text-orange-500"}),l("conversations.customerHistory.tagsTitle")]}),w.jsx("div",{className:"flex flex-wrap gap-2",children:d.tags.map((e,t)=>w.jsx("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 text-xs font-medium rounded-full",children:e},t))})]}),w.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("button",{onClick:()=>m("conversations"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[w.jsx(D,{className:"w-4 h-4 text-orange-500"}),l("conversations.customerHistory.pastConversations")," (",c.length,")"]}),"conversations"===i?w.jsx(De,{className:"w-4 h-4 text-gray-400"}):w.jsx(V,{className:"w-4 h-4 text-gray-400"})]}),"conversations"===i&&w.jsx("div",{className:"px-4 pb-4 space-y-3",children:c.map(e=>w.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-slate-900 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors cursor-pointer",children:[w.jsxs("div",{className:"flex items-start justify-between mb-2",children:[w.jsx("span",{className:"text-xs font-medium text-orange-600 dark:text-orange-400",children:e.channel}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:u(e.date)})]}),w.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:e.summary}),w.jsxs("div",{className:"flex items-center justify-between text-xs",children:[w.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[l("conversations.customerHistory.agent")," ",e.agentName]}),e.resolved&&w.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["âœ“ ",l("conversations.customerHistory.resolved")]})]})]},e.id))})]}),w.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("button",{onClick:()=>m("orders"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[w.jsx(Fe,{className:"w-4 h-4 text-orange-500"}),l("conversations.customerHistory.ordersTitle")," (",g.length,")"]}),"orders"===i?w.jsx(De,{className:"w-4 h-4 text-gray-400"}):w.jsx(V,{className:"w-4 h-4 text-gray-400"})]}),"orders"===i&&w.jsx("div",{className:"px-4 pb-4 space-y-3",children:g.map(e=>w.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-slate-900 rounded-lg",children:[w.jsxs("div",{className:"flex items-start justify-between mb-2",children:[w.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.id}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:u(e.date)})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm font-bold text-orange-600 dark:text-orange-400",children:lt(e.total,n.language)}),w.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.items," ",l("conversations.customerHistory.items")]})]})]},e.id))})]}),w.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700",children:[w.jsxs("button",{onClick:()=>m("notes"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[w.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[w.jsx(_e,{className:"w-4 h-4 text-orange-500"}),l("conversations.customerHistory.notesTitle")," (",x.length,")"]}),"notes"===i?w.jsx(De,{className:"w-4 h-4 text-gray-400"}):w.jsx(V,{className:"w-4 h-4 text-gray-400"})]}),"notes"===i&&w.jsx("div",{className:"px-4 pb-4 space-y-3",children:x.map(e=>w.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:e.author}),w.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:u(e.date)})]}),w.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.note})]},e.id))})]})]}),w.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-900",children:w.jsxs("button",{className:"w-full px-4 py-2 bg-orange-500 text-white text-sm font-medium rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center gap-2",children:[w.jsx(_e,{className:"w-4 h-4"}),l("conversations.customerHistory.addNewNote")]})})]})},oa={ui:{activeTab:"all",showQuickReplies:!1,showNotes:!1,showTags:!1,showAdvancedFilters:!1,showAssignment:!1,showKeyboardHelp:!1,showCustomerHistory:!1,showEmojiPicker:null,isFullscreen:null},data:{selectedConversation:null,messageInput:"",notes:"",attachedFiles:[],isCustomerTyping:!1,assignmentConversationId:null},filters:{searchQuery:"",filterStatus:"all",appliedFilters:null}};function da(e,t){switch(t.type){case"SET_ACTIVE_TAB":return{...e,ui:{...e.ui,activeTab:t.payload}};case"SELECT_CONVERSATION":return{...e,data:{...e.data,selectedConversation:t.payload}};case"SET_MESSAGE_INPUT":return{...e,data:{...e.data,messageInput:t.payload}};case"CLEAR_MESSAGE_INPUT":return{...e,data:{...e.data,messageInput:"",attachedFiles:[]}};case"ADD_ATTACHMENT":return{...e,data:{...e.data,attachedFiles:[...e.data.attachedFiles,t.payload]}};case"ADD_ATTACHMENTS":return{...e,data:{...e.data,attachedFiles:[...e.data.attachedFiles,...t.payload]}};case"REMOVE_ATTACHMENT":return{...e,data:{...e.data,attachedFiles:e.data.attachedFiles.filter((e,a)=>a!==t.payload)}};case"CLEAR_ATTACHMENTS":return{...e,data:{...e.data,attachedFiles:[]}};case"TOGGLE_QUICK_REPLIES":return{...e,ui:{...e.ui,showQuickReplies:!e.ui.showQuickReplies}};case"TOGGLE_NOTES":return{...e,ui:{...e.ui,showNotes:!e.ui.showNotes}};case"TOGGLE_TAGS":return{...e,ui:{...e.ui,showTags:!e.ui.showTags}};case"TOGGLE_ADVANCED_FILTERS":return{...e,ui:{...e.ui,showAdvancedFilters:!e.ui.showAdvancedFilters}};case"TOGGLE_ASSIGNMENT":return{...e,ui:{...e.ui,showAssignment:!e.ui.showAssignment},data:{...e.data,assignmentConversationId:void 0!==t.payload?t.payload:e.data.assignmentConversationId}};case"TOGGLE_KEYBOARD_HELP":return{...e,ui:{...e.ui,showKeyboardHelp:!e.ui.showKeyboardHelp}};case"TOGGLE_CUSTOMER_HISTORY":return{...e,ui:{...e.ui,showCustomerHistory:!e.ui.showCustomerHistory}};case"TOGGLE_EMOJI_PICKER":return{...e,ui:{...e.ui,showEmojiPicker:null===e.ui.showEmojiPicker||!e.ui.showEmojiPicker}};case"TOGGLE_FULLSCREEN":return{...e,ui:{...e.ui,isFullscreen:null===e.ui.isFullscreen||!e.ui.isFullscreen}};case"CLOSE_ALL_MODALS":return{...e,ui:{...e.ui,showQuickReplies:!1,showNotes:!1,showTags:!1,showAdvancedFilters:!1,showAssignment:!1,showKeyboardHelp:!1,showCustomerHistory:!1,showEmojiPicker:!1,isFullscreen:!1}};case"SET_NOTES":return{...e,data:{...e.data,notes:t.payload}};case"SET_SEARCH_QUERY":return{...e,filters:{...e.filters,searchQuery:t.payload}};case"SET_FILTER_STATUS":return{...e,filters:{...e.filters,filterStatus:t.payload}};case"SET_APPLIED_FILTERS":return{...e,filters:{...e.filters,appliedFilters:t.payload}};case"SET_CUSTOMER_TYPING":return{...e,data:{...e.data,isCustomerTyping:t.payload}};case"RESET_STATE":return oa;default:return e}}const ca=t=>{const{actions:a,selectedConversation:s,messageInput:r,attachedFiles:l,userId:n,currentAgentName:i}=t,{t:d}=j("agent"),c=(()=>{const e=f();return v(e=>dt(e),{onSuccess:(t,a)=>{p.success("Mesaj gÃ¶nderildi"),e.invalidateQueries(Xe.messages(a.conversationId)),e.invalidateQueries(Xe.all())},onError:()=>{p.error("Mesaj gÃ¶nderilemedi")}})})(),x=(()=>{const e=f();return v(({conversationId:e,agentId:t})=>gt(e,t),{onSuccess:t=>{p.success("KonuÅŸma baÅŸarÄ±yla atandÄ±"),e.invalidateQueries(Xe.all()),e.invalidateQueries(Xe.detail(t.data.id))},onError:()=>{p.error("KonuÅŸma atanamadÄ±")}})})(),m=(()=>{const e=f();return v(e=>ct(e),{onSuccess:t=>{p.success("KonuÅŸma Ã§Ã¶zÃ¼ldÃ¼"),e.invalidateQueries(Xe.all()),e.invalidateQueries(Xe.detail(t.data.id))},onError:()=>{p.error("KonuÅŸma Ã§Ã¶zÃ¼lemedi")}})})(),u=(()=>{const e=f();return v(e=>xt(e),{onSuccess:t=>{e.invalidateQueries(Xe.detail(t.data.id))},onError:()=>{}})})();return{handleTakeOver:T.useCallback(async t=>{try{e.debug("Taking over conversation",{conversationId:t.id});const s={...t,isLocked:!0,lockedBy:n,lockedByName:i,assignedTo:n,assignedToName:i,status:"assigned"};a.selectConversation(s),p.success(d("conversations.actions.conversationTakenOver",{customerName:t.customerName})),n&&await x.mutateAsync({conversationId:t.id,agentId:n})}catch(s){e.error("Failed to take over conversation",s,{conversationId:t.id}),p.error(d("voiceCall.takeoverFailed"))}},[n,i,a,x,d]),handleSendMessage:T.useCallback(async()=>{if(!r.trim()&&0===l.length||!s)return;const t=r.trim(),n=s.id,i=[...l];a.clearMessageInput();try{await c.mutateAsync({conversationId:n,content:t||d("voiceCall.messageFileSent"),attachments:i}),e.debug("Message sent successfully",{conversationId:n,filesCount:i.length})}catch(o){e.error("Failed to send message",o,{conversationId:n}),p.error(d("voiceCall.messageSendFailed")),a.setMessageInput(t),a.addAttachments(i)}},[r,l,s,a,c,d]),handleResolve:T.useCallback(async()=>{if(!s)return;const t=s.id;try{e.debug("Resolving conversation",{conversationId:t}),a.selectConversation({...s,status:"resolved",isLocked:!1}),p.success(d("voiceCall.conversationClosed")),await m.mutateAsync(t),setTimeout(()=>{a.selectConversation(null)},1500)}catch(r){e.error("Failed to resolve conversation",r,{conversationId:t}),p.error(d("voiceCall.conversationCloseFailed"))}},[s,a,m,d]),handleSelectConversation:T.useCallback(e=>{a.selectConversation(e),e&&e.unreadCount>0&&u.mutate(e.id)},[a,u]),handleCopyMessage:T.useCallback((t,a)=>{navigator.clipboard.writeText(a).then(()=>{o(d("conversations.actions.messageCopied"))}).catch(t=>{e.error("Failed to copy message",t),g(d("conversations.actions.copyFailed"))})},[d]),canSendMessage:s&&(s.assignedTo===n||!s.isLocked)}},ga=e=>{const{t:t}=j("agent"),{actions:a,selectedConversation:s,messageInput:r,isFullscreen:l,canSendMessage:n,filteredConversations:i,searchInputRef:o,messageInputRef:d,showQuickReplies:c,showTags:g,showAdvancedFilters:x,showAssignment:m,showKeyboardHelp:u,onSendMessage:h,onResolve:b}=e;T.useEffect(()=>{const e=e=>{"Escape"===e.key&&(ea(l)?a.toggleFullscreen():s&&a.selectConversation(null)),"F11"===e.key&&s&&(e.preventDefault(),a.toggleFullscreen())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l,s,a]);const p=!(c||g||x||m||u);((e,t=!0)=>{T.useEffect(()=>{if(!t)return;const a=t=>{for(const a of e){const e=a.ctrl?t.ctrlKey||t.metaKey:!t.ctrlKey&&!t.metaKey,s=a.alt?t.altKey:!t.altKey,r=a.shift?t.shiftKey:!t.shiftKey,l=t.key.toLowerCase()===a.key.toLowerCase();if(e&&s&&r&&l){!1!==a.preventDefault&&t.preventDefault(),a.action();break}}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e,t])})([{key:"k",ctrl:!0,description:t("keyboard.focusSearch"),action:()=>{var e;return null==(e=o.current)?void 0:e.focus()}},{key:"Enter",ctrl:!0,description:t("keyboard.sendMessage"),action:()=>{n&&r.trim()&&h()}},{key:"/",description:t("keyboard.quickReplies"),action:()=>{document.activeElement===d.current&&a.toggleQuickReplies()},preventDefault:!0},{key:"Escape",description:t("keyboard.closeModals"),action:()=>{a.closeAllModals()},preventDefault:!1},{key:"n",ctrl:!0,description:t("keyboard.nextConversation"),action:()=>{if(!s)return;const e=i.findIndex(e=>e.id===s.id);e<i.length-1&&a.selectConversation(i[e+1])}},{key:"p",ctrl:!0,description:t("keyboard.previousConversation"),action:()=>{if(!s)return;const e=i.findIndex(e=>e.id===s.id);e>0&&a.selectConversation(i[e-1])}},{key:"r",ctrl:!0,description:t("keyboard.resolveConversation"),action:()=>{s&&n&&b()}},{key:"?",description:t("keyboard.showShortcuts"),action:()=>a.toggleKeyboardHelp(),preventDefault:!0},{key:"t",ctrl:!0,shift:!0,description:t("keyboard.addTags"),action:()=>{s&&a.toggleTags()}}],p)};function xa(e,t){return e.filter(e=>{if("phone"===t.activeTab){if("phone"!==e.channel)return!1}else if("my"===t.activeTab){if(e.assignedTo!==t.userId||"phone"===e.channel)return!1}else if("waiting"===t.activeTab&&("waiting"!==e.status||"phone"===e.channel))return!1;if(t.searchQuery){const a=t.searchQuery.toLowerCase(),s=e.customerName.toLowerCase().includes(a),r=e.lastMessage.toLowerCase().includes(a);if(!s&&!r)return!1}if(t.status&&"all"!==t.status&&e.status!==t.status)return!1;if(t.priority&&e.priority!==t.priority)return!1;if(t.channel&&e.channel!==t.channel)return!1;if(t.assignedTo&&e.assignedTo!==t.assignedTo)return!1;if(void 0!==t.hasUnread){const a=e.unreadCount>0;if(t.hasUnread!==a)return!1}return void 0===t.isAiStuck||e.aiStuck===t.isAiStuck})}function ma(e){return{id:e.id,sender:e.sender,content:e.content,timestamp:e.timestamp,senderName:e.senderName??"Unknown",isRead:e.isRead??!1,text:e.content,agentName:e.senderName??void 0}}const ua=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{t:t}=j("agent"),[a,s]=I(),{state:r,actions:l}=function(){const[e,t]=T.useReducer(da,oa);return{state:e,actions:{setActiveTab:T.useCallback(e=>{t({type:"SET_ACTIVE_TAB",payload:e})},[]),selectConversation:T.useCallback(e=>{t({type:"SELECT_CONVERSATION",payload:e})},[]),setMessageInput:T.useCallback(e=>{t({type:"SET_MESSAGE_INPUT",payload:e})},[]),clearMessageInput:T.useCallback(()=>{t({type:"CLEAR_MESSAGE_INPUT"})},[]),addAttachment:T.useCallback(e=>{t({type:"ADD_ATTACHMENT",payload:e})},[]),addAttachments:T.useCallback(e=>{t({type:"ADD_ATTACHMENTS",payload:e})},[]),removeAttachment:T.useCallback(e=>{t({type:"REMOVE_ATTACHMENT",payload:e})},[]),clearAttachments:T.useCallback(()=>{t({type:"CLEAR_ATTACHMENTS"})},[]),toggleQuickReplies:T.useCallback(()=>{t({type:"TOGGLE_QUICK_REPLIES"})},[]),toggleNotes:T.useCallback(()=>{t({type:"TOGGLE_NOTES"})},[]),toggleTags:T.useCallback(()=>{t({type:"TOGGLE_TAGS"})},[]),toggleAdvancedFilters:T.useCallback(()=>{t({type:"TOGGLE_ADVANCED_FILTERS"})},[]),toggleAssignment:T.useCallback(e=>{t({type:"TOGGLE_ASSIGNMENT",payload:e})},[]),toggleKeyboardHelp:T.useCallback(()=>{t({type:"TOGGLE_KEYBOARD_HELP"})},[]),toggleCustomerHistory:T.useCallback(()=>{t({type:"TOGGLE_CUSTOMER_HISTORY"})},[]),toggleEmojiPicker:T.useCallback(()=>{t({type:"TOGGLE_EMOJI_PICKER"})},[]),toggleFullscreen:T.useCallback(()=>{t({type:"TOGGLE_FULLSCREEN"})},[]),closeAllModals:T.useCallback(()=>{t({type:"CLOSE_ALL_MODALS"})},[]),setNotes:T.useCallback(e=>{t({type:"SET_NOTES",payload:e})},[]),setSearchQuery:T.useCallback(e=>{t({type:"SET_SEARCH_QUERY",payload:e})},[]),setFilterStatus:T.useCallback(e=>{t({type:"SET_FILTER_STATUS",payload:e})},[]),setAppliedFilters:T.useCallback(e=>{t({type:"SET_APPLIED_FILTERS",payload:e})},[]),setCustomerTyping:T.useCallback(e=>{t({type:"SET_CUSTOMER_TYPING",payload:e})},[]),resetState:T.useCallback(()=>{t({type:"RESET_STATE"})},[])}}}(),{user:n}=i(),[d,c]=T.useState(null),g=T.useRef(null),x=(null==n?void 0:n.name)||"Agent",{data:m,isLoading:u}=pt({limit:100}),h=T.useMemo(()=>m||[],[m]),b=h,p={all:"all",my:"my",waiting:"waiting",assigned:"assigned"},y=T.useMemo(()=>({activeTab:p[r.ui.activeTab],searchQuery:r.filters.searchQuery,status:r.filters.filterStatus,userId:null==n?void 0:n.id}),[r.ui.activeTab,r.filters.searchQuery,r.filters.filterStatus,null==n?void 0:n.id]),f=T.useMemo(()=>function(e,t="priority",a="desc"){const s=[...e];return s.sort((e,s)=>{let r=0;switch(t){case"priority":{const t=Dt[e.priority]||0;r=(Dt[s.priority]||0)-t,0===r&&(r=s.unreadCount-e.unreadCount);break}case"lastMessageTime":{const t=new Date(e.lastMessageTime).getTime();r=new Date(s.lastMessageTime).getTime()-t;break}case"createdAt":{const t=new Date(e.createdAt||e.lastMessageTime).getTime();r=new Date(s.createdAt||s.lastMessageTime).getTime()-t;break}case"unreadCount":r=s.unreadCount-e.unreadCount;break;default:r=0}return"asc"===a?-r:r}),s}(xa(b,y),"priority","desc"),[b,y]),v=ca({actions:l,selectedConversation:r.data.selectedConversation,messageInput:r.data.messageInput,attachedFiles:r.data.attachedFiles,userId:null==n?void 0:n.id,currentAgentName:x});(e=>{const{selectedConversation:t,messageInput:a,actions:s}=e;T.useEffect(()=>{if(!t)return;const e=`draft_${t.id}`,a=localStorage.getItem(e);a?s.setMessageInput(a):s.setMessageInput("")},[t,s]),T.useEffect(()=>{if(!t||!a.trim())return;const e=`draft_${t.id}`,s=setTimeout(()=>{localStorage.setItem(e,a)},2e3);return()=>clearTimeout(s)},[a,t])})({selectedConversation:r.data.selectedConversation,messageInput:r.data.messageInput,actions:l});const k={actions:l,selectedConversation:r.data.selectedConversation,messageInput:r.data.messageInput,isFullscreen:r.ui.isFullscreen,canSendMessage:v.canSendMessage,filteredConversations:f,searchInputRef:g,messageInputRef:{current:null},showQuickReplies:r.ui.showQuickReplies,showTags:r.ui.showTags,showAdvancedFilters:r.ui.showAdvancedFilters,showAssignment:r.ui.showAssignment,showKeyboardHelp:r.ui.showKeyboardHelp,onSendMessage:v.handleSendMessage,onResolve:v.handleResolve};return ga({...k,canSendMessage:k.canSendMessage??!1}),T.useEffect(()=>{const e=a.get("openConversation");if(e&&!r.data.selectedConversation){const t=h.find(t=>t.id===e);t&&(v.handleSelectConversation(t),s({}))}},[a,h,r.data.selectedConversation,s,v]),w.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)] bg-slate-50 dark:bg-slate-900",children:[w.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 p-4 sm:p-6",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:t("conversations.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("conversations.count",{count:f.length})})]}),w.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:w.jsxs("button",{onClick:()=>l.toggleAdvancedFilters(),className:"px-3 py-1.5 text-sm font-medium rounded-lg transition-colors bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 hover:bg-purple-200 dark:hover:bg-purple-900/50 flex items-center gap-2",type:"button",children:[w.jsx(Te,{className:"w-4 h-4"}),w.jsx("span",{className:"hidden sm:inline",children:t("conversations.filters.filters")}),r.filters.appliedFilters&&w.jsx("span",{className:"bg-purple-500 text-white text-xs px-1.5 py-0.5 rounded-full",children:(r.filters.appliedFilters.channels.length||0)+(r.filters.appliedFilters.tags.length||0)+(r.filters.appliedFilters.assignedTo.length||0)+(r.filters.appliedFilters.priority.length||0)+(r.filters.appliedFilters.dateRange?1:0)})]})})]}),w.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide",children:["all","assigned","my","waiting"].map(e=>w.jsxs("button",{onClick:()=>l.setActiveTab(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap "+(r.ui.activeTab===e?"bg-orange-500 text-white":"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600"),type:"button",children:[t(`conversations.tabs.${e}`),w.jsxs("span",{className:"ml-1.5 text-xs opacity-75",children:["(",xa(b,{...y,activeTab:e}).length,")"]})]},e))}),w.jsxs("div",{className:"mt-4 relative",children:[w.jsx(Ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),w.jsx("input",{ref:g,type:"text",placeholder:t("conversations.searchWithShortcut"),value:r.filters.searchQuery,onChange:e=>l.setSearchQuery(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 text-gray-900 dark:text-gray-100"})]})]}),w.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[w.jsx("div",{className:"w-full sm:w-96 border-r border-gray-200 dark:border-slate-700 overflow-y-auto",children:w.jsx(Zt,{conversations:f,selectedConversation:r.data.selectedConversation,currentUserId:"current-user-id",onSelect:v.handleSelectConversation,onTakeOver:v.handleTakeOver,onAssign:e=>l.toggleAssignment(e)})}),w.jsx("div",{className:"flex-1 flex flex-col",children:r.data.selectedConversation?w.jsxs(w.Fragment,{children:[w.jsx(qt,{customerName:r.data.selectedConversation.customerName,channel:r.data.selectedConversation.channel,isFullscreen:r.ui.isFullscreen??!1,isMobile:!1,canSendMessage:!r.data.selectedConversation.isLocked||"current-user-id"===r.data.selectedConversation.lockedBy,isAssignedToCurrentUser:"current-user-id"===r.data.selectedConversation.assignedTo,isLocked:r.data.selectedConversation.isLocked,status:r.data.selectedConversation.status,onClose:()=>l.selectConversation(null),onBack:()=>l.selectConversation(null),onToggleFullscreen:()=>l.toggleFullscreen(),onToggleNotes:()=>l.toggleNotes(),onToggleTags:()=>{},onResolve:()=>v.handleResolve(),onTakeOver:()=>v.handleTakeOver(r.data.selectedConversation)}),w.jsx(Xt,{messages:(N=Array.from(r.data.selectedConversation.messages||[]),N.map(ma)),isCustomerTyping:r.data.isCustomerTyping,copiedMessageId:d,onCopyMessage:(e,t)=>{v.handleCopyMessage(e,t),c(e),setTimeout(()=>c(null),2e3)}}),(()=>{var e,t;const a={messageInput:r.data.messageInput,attachedFiles:r.data.attachedFiles,showEmojiPicker:r.ui.showEmojiPicker,canSendMessage:v.canSendMessage,isLocked:(null==(e=r.data.selectedConversation)?void 0:e.isLocked)||!1,lockedBy:null==(t=r.data.selectedConversation)?void 0:t.lockedBy,onMessageChange:e=>l.setMessageInput(e),onSendMessage:v.handleSendMessage,onAddFiles:e=>l.addAttachments(e),onRemoveFile:e=>l.removeAttachment(e),onResolve:v.handleResolve,onToggleQuickReplies:()=>l.toggleQuickReplies(),onToggleEmojiPicker:()=>l.toggleEmojiPicker(),onEmojiSelect:e=>l.setMessageInput(r.data.messageInput+e),onToggleNotes:()=>l.toggleNotes()};return w.jsx(ta,{...{...a,canSendMessage:a.canSendMessage??!1}})})()]}):w.jsx("div",{className:"flex-1 flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx(D,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("conversations.selectConversation")})]})})})]}),r.ui.showQuickReplies&&w.jsx(aa,{onSelect:e=>l.setMessageInput(e),onClose:()=>l.toggleQuickReplies()}),r.ui.showNotes&&r.data.selectedConversation&&w.jsxs("div",{className:"fixed right-4 bottom-24 w-80 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 overflow-hidden z-40",children:[w.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-900 border-b border-gray-200 dark:border-slate-700 flex items-center justify-between",children:[w.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[w.jsx(de,{className:"w-4 h-4"}),t("conversations.notes.title")]}),w.jsx("button",{onClick:()=>l.toggleNotes(),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",type:"button",children:"âœ•"})]}),w.jsxs("div",{className:"p-4",children:[w.jsx("textarea",{value:r.data.notes,onChange:e=>l.setNotes(e.target.value),placeholder:t("conversations.addNotesPlaceholder"),className:"w-full h-32 px-3 py-2 bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 text-gray-900 dark:text-gray-100 text-sm resize-none"}),w.jsx("button",{onClick:()=>{e.debug("Saving notes",{conversationId:r.data.selectedConversation.id,notes:r.data.notes}),o(t("conversations.notes.saved")),l.toggleNotes()},className:"mt-2 w-full px-4 py-2 bg-orange-500 text-white text-sm font-medium rounded-lg hover:bg-orange-600 transition-colors",type:"button",children:t("common:save")})]})]}),r.ui.showTags&&r.data.selectedConversation&&w.jsx(sa,{conversationId:r.data.selectedConversation.id,currentTags:[],onClose:()=>l.toggleTags()}),r.ui.showAdvancedFilters&&w.jsx(ra,{onClose:()=>l.toggleAdvancedFilters(),onApply:a=>{l.setAppliedFilters(a),e.debug("Filters applied",{filters:a}),o(t("conversations.filters.applied"))}}),r.ui.showAssignment&&r.data.assignmentConversationId&&w.jsx(la,{conversationId:r.data.assignmentConversationId,onClose:()=>{l.toggleAssignment(null)},onAssign:(a,s,n)=>{e.debug("Assigning conversation",{conversationId:r.data.assignmentConversationId,agentId:a,mode:s,reason:n});const i=n?t("conversations.assignment.successWithReason",{reason:n}):t("conversations.assignment.success");o(i),l.toggleAssignment(null)}}),r.ui.showKeyboardHelp&&w.jsx(na,{onClose:()=>l.toggleKeyboardHelp()}),r.ui.showCustomerHistory&&r.data.selectedConversation&&w.jsx(ia,{customerId:r.data.selectedConversation.id,customerName:r.data.selectedConversation.customerName,customerEmail:`${r.data.selectedConversation.customerName.toLowerCase().replace(" ",".")}@example.com`,customerPhone:"+90 532 123 45 67",onClose:()=>l.toggleCustomerHistory()})]});var N}},Symbol.toStringTag,{value:"Module"})),ha=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{t:t,i18n:a}=j("agent"),{id:s}=A(),r=S(),l=T.useRef(null),[n,i]=T.useState(""),o={customerName:t("conversations.detail.loading"),customerPhone:"",messages:[]};T.useEffect(()=>{var e;null==(e=l.current)||e.scrollIntoView({behavior:"smooth"})},[o.messages]);const d=()=>{n.trim()&&(e.debug("Message sent",{conversationId:s,message:n}),i(""))},c=e=>{const t="tr"===a.language?"tr-TR":"en-US";return new Intl.DateTimeFormat(t,{hour:"2-digit",minute:"2-digit"}).format(e)};return w.jsxs("div",{className:"flex flex-col h-screen bg-slate-50 dark:bg-slate-900",children:[w.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 p-4",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("button",{type:"button",onClick:()=>r("/agent/conversations"),className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(Le,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center",children:w.jsx(L,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-white dark:border-slate-800 rounded-full"})]}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o.customerName}),w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o.customerPhone})]})]}),w.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[w.jsxs("span",{className:"px-3 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-semibold",children:["ðŸš¨ ",t("conversations.detail.urgentPriority")]}),w.jsxs("span",{className:"px-3 py-1 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-semibold",children:["âœ… ",t("conversations.detail.activePriority")]})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(X,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(Oe,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(He,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})]})}),w.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[w.jsx("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 text-white p-4 rounded-lg mb-4",children:w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:w.jsx(q,{className:"w-6 h-6"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-bold text-lg",children:t("conversations.detail.emergencyCallTakenOver")}),w.jsx("p",{className:"text-sm text-white/90",children:t("conversations.detail.emergencyCallDescription")})]})]})}),o.messages.map(e=>w.jsx("div",{className:"flex "+("agent"===e.sender?"justify-end":"justify-start"),children:w.jsxs("div",{className:"max-w-[70%] "+("agent"===e.sender?"order-2":"order-1"),children:["agent"!==e.sender&&w.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 ml-1",children:[e.senderName," ","ai"===e.sender&&t("conversations.detail.aiAssistant")]}),w.jsxs("div",{className:"rounded-lg p-3 "+("customer"===e.sender?"bg-white dark:bg-slate-800 text-gray-900 dark:text-white":"ai"===e.sender?"bg-blue-100 dark:bg-blue-900/30 text-blue-900 dark:text-blue-300":"bg-blue-600 text-white"),children:[w.jsx("p",{className:"text-sm",children:e.content}),w.jsxs("div",{className:"flex items-center justify-end gap-1 mt-1",children:[w.jsx("p",{className:"text-xs opacity-70",children:c(e.timestamp)}),"agent"===e.sender&&("read"===e.status||"delivered"===e.status)&&w.jsx($e,{className:"w-4 h-4"})]})]})]})},e.id)),w.jsx("div",{ref:l})]}),w.jsx("div",{className:"bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-700 p-4",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(ve,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w.jsx(Ne,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),w.jsx("input",{type:"text",value:n,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&d(),placeholder:t("conversations.messagePlaceholder"),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-slate-900 text-gray-900 dark:text-white"}),w.jsxs("button",{type:"button",onClick:d,disabled:!n.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[w.jsx(we,{className:"w-5 h-5"}),w.jsx("span",{className:"hidden sm:inline",children:t("conversations.detail.send")})]})]})})]})}},Symbol.toStringTag,{value:"Module"})),ba="http://localhost:3001",pa="/api/v1/appointments",ya="/api/v1/ai/ask",fa=5e3,va="authToken",ja=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{t:t,i18n:a}=j("agent"),{id:s}=A(),r=S(),{activeCall:l}=vt(),[n,i]=T.useState(!0),[o,d]=T.useState(0),[c,g]=T.useState(!1),[x,m]=T.useState(!0),[u,h]=T.useState(!1),[b,y]=T.useState(!0),[f,v]=T.useState(""),[k,N]=T.useState(!0),[C,I]=T.useState(!1),[E,M]=T.useState(""),[R,D]=T.useState(""),[O,H]=T.useState(!1),[P,B]=T.useState(null),[Q,z]=T.useState(!1),[G,K]=T.useState(!1),[U,W]=T.useState(!1),[J,Y]=T.useState({date:"",time:"",duration:String(60),service:"",notes:""});e.debug("ðŸ“ž VoiceCallScreen loaded, Conversation ID:",{conversationId:s}),T.useEffect(()=>{(async()=>{try{e.debug("ðŸ”Œ Connecting to call...",{conversationId:s}),await new Promise(e=>setTimeout(e,2e3+1e3*Math.random())),i(!1),e.debug("âœ… Connection established!")}catch(a){e.error("âŒ Connection error:",a),i(!1),p.error(t("voice.connectionFailed")),setTimeout(()=>r("/agent/conversations"),2e3)}})()},[s,r,t]),T.useEffect(()=>{if(n)return;const e=setInterval(()=>{d(e=>e+1)},1e3);return()=>clearInterval(e)},[n]);const ee=l?{name:l.customerName,phone:l.customerPhone,email:l.customerEmail,avatar:l.customerAvatar,previousIssues:[]}:{name:"Customer",phone:"",email:"",avatar:void 0,previousIssues:[]},te=(null==l?void 0:l.messages)||[];T.useEffect(()=>{if(!f.trim())return;const e=setTimeout(()=>{oe()},fa);return()=>clearTimeout(e)},[f]);const oe=async()=>{if(f.trim()){z(!0);try{e.debug("Saving notes:",{conversationId:s,notes:f}),await new Promise(e=>setTimeout(e,500)),B(new Date),e.debug("Notes saved successfully")}catch(a){e.error("Failed to save notes:",a),p.error(t("voiceCall.notesSaveFailed"))}finally{z(!1)}}},ce=async()=>{if(E.trim()){H(!0),D("");try{e.debug("AI Assistant question:",{question:E,conversationId:s,customerId:ee.phone});const a=localStorage.getItem(va),r=await fetch(`${ba}${ya}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({question:E,conversationId:s,customerId:ee.phone,context:{callDuration:o,notes:f,conversationHistory:te.slice(-5)}})});if(!r.ok)throw new Error("AI API request failed");const l=await r.json();D(l.answer||l.response||t("voiceCall.aiNoResponse")),("create_appointment"===l.suggestedAction||l.isAppointmentRequest)&&K(!0),p.success(t("voiceCall.aiResponseReady"))}catch(a){e.error("AI question failed:",a),p.error(t("voiceCall.aiResponseFailed"))}finally{H(!1)}}else p.error(t("voiceCall.pleaseWriteQuestion"))};return w.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 via-blue-700 to-purple-700 dark:from-slate-800 dark:via-slate-900 dark:to-slate-950 z-50 overflow-hidden",children:[n&&w.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center",children:w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 text-center",children:[w.jsx("div",{className:"flex justify-center mb-4",children:w.jsxs("div",{className:"relative w-16 h-16 flex items-center justify-center",children:[w.jsx("div",{className:"flex items-center justify-center gap-1",children:[0,1,2].map(e=>w.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}),w.jsx(X,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]})}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:t("voice.connecting")}),w.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:t("voice.connectingDescription")}),w.jsxs("div",{className:"flex items-center justify-center gap-1",children:[w.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),w.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),w.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}),w.jsx("div",{className:"bg-white/10 dark:bg-white/5 backdrop-blur-md border-b border-white/20 dark:border-white/10 p-2 sm:p-3",children:w.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[w.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white/20 flex items-center justify-center flex-shrink-0",children:ee.avatar?w.jsx("img",{src:ee.avatar,alt:ee.name,className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full"}):w.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),w.jsxs("div",{className:"min-w-0",children:[w.jsx("h2",{className:"text-base sm:text-lg font-bold text-white truncate",children:ee.name}),w.jsx("p",{className:"text-white/70 text-xs truncate",children:ee.phone})]})]}),w.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:w.jsxs("div",{className:"text-center",children:[w.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-white/90",children:[w.jsx($,{className:"w-3 h-3 sm:w-4 sm:h-4"}),w.jsx("span",{className:"text-xl sm:text-2xl font-mono font-bold",children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(o)})]}),w.jsx("div",{className:"text-white/60 text-xs hidden sm:block",children:u?`â¸ï¸ ${t("conversations.voiceCall.onHold")}`:`ðŸ”´ ${t("conversations.voiceCall.active")}`})]})})]})}),w.jsx("div",{className:"max-w-6xl mx-auto p-2 sm:p-3 h-[calc(100vh-140px)] sm:h-[calc(100vh-140px)] overflow-y-auto",children:w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-2 sm:gap-3",children:[w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"bg-white/10 dark:bg-white/5 backdrop-blur-md rounded-lg sm:rounded-xl p-2 sm:p-3 border border-white/20 dark:border-white/10",children:[w.jsxs("button",{type:"button",onClick:()=>N(!k),className:"w-full flex items-center justify-between mb-2",children:[w.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-white",children:[w.jsx(F,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),w.jsx("h3",{className:"text-xs sm:text-sm font-semibold",children:t("conversations.voiceCall.aiHistory")})]}),k?w.jsx(De,{className:"w-4 h-4 text-white"}):w.jsx(V,{className:"w-4 h-4 text-white"})]}),k&&w.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:te.map(e=>w.jsxs("div",{className:"p-2 rounded-lg "+("customer"===e.sender?"bg-white/20":"bg-blue-500/30"),children:[w.jsx("div",{className:"flex items-center gap-1 mb-1",children:w.jsx("span",{className:"text-xs text-white/60",children:e.senderName})}),w.jsx("p",{className:"text-xs text-white/90 line-clamp-2",children:e.content})]},e.id))})]}),w.jsxs("div",{className:"bg-white/10 dark:bg-white/5 backdrop-blur-md rounded-lg sm:rounded-xl p-2 sm:p-3 border border-white/20 dark:border-white/10",children:[w.jsx("div",{className:"flex items-center justify-between mb-2",children:w.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-white",children:[w.jsx(de,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),w.jsx("h3",{className:"text-xs sm:text-sm font-semibold",children:t("conversations.voiceCall.notesTitle")}),Q&&w.jsx("div",{className:"flex items-center justify-center gap-0.5",children:[0,1,2].map(e=>w.jsx("div",{className:"w-0.5 h-0.5 rounded-full bg-blue-300 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))})]})}),w.jsx("textarea",{value:f,onChange:e=>v(e.target.value),placeholder:t("voiceCall.notesPlaceholder"),className:"w-full h-24 sm:h-32 bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded-lg p-2 text-xs sm:text-sm text-white placeholder-white/50 dark:placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/50 dark:focus:ring-white/30 resize-none"}),P&&w.jsxs("div",{className:"mt-1 text-xs text-white/50",children:["âœ“ ",rt(P,a.language)]})]}),w.jsxs("div",{className:"bg-amber-500/20 dark:bg-amber-500/10 backdrop-blur-md rounded-lg sm:rounded-xl p-2 sm:p-3 border border-amber-400/30 dark:border-amber-400/20",children:[w.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-amber-100 mb-2",children:[w.jsx(q,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),w.jsx("h3",{className:"text-xs sm:text-sm font-semibold",children:t("conversations.voiceCall.previousIssues")})]}),w.jsx("ul",{className:"space-y-1",children:ee.previousIssues.map((e,t)=>w.jsxs("li",{className:"text-xs text-amber-50/90",children:["â€¢ ",e]},t))})]})]}),w.jsx("div",{className:"lg:col-span-2",children:w.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 dark:from-purple-500/10 dark:to-pink-500/10 backdrop-blur-md rounded-lg sm:rounded-xl p-2 sm:p-3 border border-purple-400/30 dark:border-purple-400/20 h-full",children:[w.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-white mb-2 sm:mb-3",children:[w.jsx(_,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),w.jsx("h3",{className:"text-xs sm:text-sm font-semibold",children:t("conversations.voiceCall.aiAssistantTitle")}),w.jsx(Pe,{className:"w-3 h-3 text-yellow-300"})]}),w.jsxs("div",{className:"flex gap-1.5 sm:gap-2 mb-2 sm:mb-3",children:[w.jsx("input",{type:"text",value:E,onChange:e=>M(e.target.value),onKeyPress:e=>{"Enter"!==e.key||O||ce()},placeholder:t("voiceCall.askQuestionPlaceholder"),className:"flex-1 px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded-lg text-white placeholder-white/50 dark:placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-purple-400 dark:focus:ring-purple-500",disabled:O}),w.jsx("button",{type:"button",onClick:ce,disabled:O||!E.trim(),className:"px-3 py-2 bg-purple-500 hover:bg-purple-600 dark:bg-purple-600 dark:hover:bg-purple-700 disabled:bg-gray-500 dark:disabled:bg-gray-600 disabled:opacity-50 text-white rounded-lg transition-colors",children:O?w.jsx("div",{className:"flex items-center justify-center gap-0.5 w-4 h-4",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-white animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):w.jsx(we,{className:"w-4 h-4"})})]}),O&&w.jsx("div",{className:"bg-white/10 dark:bg-white/5 border border-purple-300/30 dark:border-purple-300/20 rounded-lg p-3 mb-3",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"flex items-center justify-center gap-0.5",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}),w.jsx("span",{className:"text-sm text-purple-200",children:t("conversations.voiceCall.thinking")})]})}),R&&!O&&w.jsxs("div",{className:"bg-white/10 dark:bg-white/5 border border-purple-300/30 dark:border-purple-300/20 rounded-lg p-3 mb-3",children:[w.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[w.jsx(_,{className:"w-3 h-3 text-purple-300"}),w.jsx("span",{className:"text-xs text-purple-200 font-semibold",children:t("conversations.voiceCall.response")})]}),w.jsx("p",{className:"text-white/90 text-sm",children:R})]}),G&&w.jsxs("div",{className:"bg-green-500/20 dark:bg-green-500/10 border border-green-400/30 dark:border-green-400/20 rounded-lg p-3",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:["ðŸ“… ",t("conversations.voiceCall.createAppointment")]}),w.jsx("button",{type:"button",onClick:()=>K(!1),className:"text-white/60 hover:text-white",children:"âœ•"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx("input",{type:"date",value:J.date,onChange:e=>Y({...J,date:e.target.value}),className:"px-2 py-1 text-sm bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded text-white focus:outline-none focus:ring-2 focus:ring-green-400 dark:focus:ring-green-500"}),w.jsx("input",{type:"time",value:J.time,onChange:e=>Y({...J,time:e.target.value}),className:"px-2 py-1 text-sm bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded text-white focus:outline-none focus:ring-2 focus:ring-green-400 dark:focus:ring-green-500"})]}),w.jsx("input",{type:"text",placeholder:t("voiceCall.serviceOptional"),value:J.service,onChange:e=>Y({...J,service:e.target.value}),className:"w-full px-2 py-1 text-sm bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded text-white placeholder-white/50 dark:placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-green-400 dark:focus:ring-green-500"}),w.jsx("textarea",{placeholder:t("voiceCall.noteOptional"),value:J.notes,onChange:e=>Y({...J,notes:e.target.value}),rows:2,className:"w-full px-2 py-1 text-sm bg-white/20 dark:bg-white/10 border border-white/30 dark:border-white/20 rounded text-white placeholder-white/50 dark:placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-green-400 dark:focus:ring-green-500 resize-none"}),w.jsx("button",{type:"button",onClick:async()=>{if(J.date&&J.time){W(!0);try{e.debug("Creating appointment:",J);const a=await fetch(`${ba}${pa}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(va)}`},body:JSON.stringify({customerId:ee.phone.replace(/\s/g,""),customerName:ee.name,customerPhone:ee.phone,customerEmail:ee.email,appointmentDate:J.date,appointmentTime:J.time,duration:parseInt(J.duration)||60,service:J.service,notes:J.notes,conversationId:s})});if(!a.ok)throw new Error(t("voiceCall.appointmentCreateFailed"));const r=await a.json();e.debug("Appointment created successfully:",r),p.success(t("voiceCall.appointmentCreated")),Y({date:"",time:"",duration:String(60),service:"",notes:""}),K(!1),v(e=>`${e}\n\nâœ… ${t("conversations.voiceCall.createAppointment")}:\n- ${t("common:common.labels.date")}: ${J.date}\n- ${t("common:common.labels.time")}: ${J.time}\n- ${t("voiceCall.serviceOptional")}: ${J.service||t("common:common.labels.notSpecified")}\n- ${t("voiceCall.noteOptional")}: ${J.notes||t("common:common.labels.none")}`)}catch(a){e.error("Failed to create appointment:",a),p.error(a instanceof Error?a.message:t("voiceCall.appointmentCreateFailed"))}finally{W(!1)}}else p.error(t("voiceCall.selectDateTime"))},disabled:U||!J.date||!J.time,className:"w-full px-3 py-2 bg-green-500 hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700 disabled:bg-gray-500 dark:disabled:bg-gray-600 disabled:opacity-50 text-white text-sm rounded-lg transition-colors flex items-center justify-center gap-2",children:U?w.jsx("div",{className:"flex items-center justify-center gap-0.5",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-white animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):w.jsx(w.Fragment,{children:w.jsx("span",{children:t("conversations.voiceCall.createAppointment")})})})]})]})]})})]})}),w.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white/10 dark:bg-white/5 backdrop-blur-md border-t border-white/20 dark:border-white/10 p-2 sm:p-3",children:w.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-center gap-2 sm:gap-3",children:[w.jsx("button",{type:"button",onClick:()=>{g(!c)},className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-all "+(c?"bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700":"bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20"),title:t(c?"voiceCall.unmuteMic":"voiceCall.muteMic"),children:c?w.jsx(se,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):w.jsx(re,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),w.jsx("button",{type:"button",onClick:()=>{m(!x)},className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-all "+(x?"bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20":"bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700"),title:t(x?"voiceCall.muteSpeaker":"voiceCall.unmuteSpeaker"),children:x?w.jsx(ne,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):w.jsx(ie,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),w.jsx("button",{type:"button",onClick:()=>{h(!u)},className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-all "+(u?"bg-yellow-500 hover:bg-yellow-600 dark:bg-yellow-600 dark:hover:bg-yellow-700":"bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20"),title:t(u?"conversations.voiceCall.continue":"conversations.voiceCall.hold"),children:u?w.jsx(le,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):w.jsx(ae,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),w.jsx("button",{type:"button",onClick:()=>{r("/agent/conversations")},className:"w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700 flex items-center justify-center transition-all shadow-lg hover:scale-105 transform",title:t("voiceCall.end"),children:w.jsx(Z,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})})]})})]})}},Symbol.toStringTag,{value:"Module"})),ka="agent_preferences",Na={emailNotifications:!0,pushNotifications:!0,desktopNotifications:!0,soundEnabled:!0,callSounds:!0,chatSounds:!0,language:"tr",autoAssign:!0,theme:"light"};const wa=new class{async getAll(){await this.simulateNetworkDelay();try{const t=localStorage.getItem(ka);if(!t)return e.debug("[MOCK] No preferences found, returning defaults"),{...Na};const a=JSON.parse(t);return e.debug("[MOCK] Preferences loaded from localStorage",a),{...Na,...a}}catch(t){return e.error("[MOCK] Failed to load preferences",t),{...Na}}}async update(t,a){await this.simulateNetworkDelay();try{const s={...await this.getAll(),[t]:a};return localStorage.setItem(ka,JSON.stringify(s)),e.debug("[MOCK] Preference updated",{key:t,value:a}),s}catch(s){throw e.error("[MOCK] Failed to save preference",s),new Error("Failed to save preference")}}async updateMultiple(t){await this.simulateNetworkDelay();try{const a={...await this.getAll(),...t};return localStorage.setItem(ka,JSON.stringify(a)),e.debug("[MOCK] Preferences updated",{preferences:t}),a}catch(a){throw e.error("[MOCK] Failed to save preferences",a),new Error("Failed to save preferences")}}async reset(){await this.simulateNetworkDelay();try{return localStorage.setItem(ka,JSON.stringify(Na)),e.debug("[MOCK] Preferences reset to defaults"),{...Na}}catch(t){throw e.error("[MOCK] Failed to reset preferences",t),new Error("Failed to reset preferences")}}async simulateNetworkDelay(){return new Promise(e=>setTimeout(e,300))}};e.info("[PreferencesService] Using MOCK (localStorage) implementation");const Ca=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{t:t,i18n:a}=j("agent"),{user:s}=i(),{theme:r,toggleTheme:l}=x(),[n,d]=T.useState(!1),[c,b]=T.useState(!1),[p,y]=T.useState(!1),[f,v]=T.useState({name:"",email:"",phone:"",bio:""}),[k,N]=T.useState(f),[C,S]=T.useState(!1),[I,A]=T.useState({emailNotifications:!0,pushNotifications:!0,desktopNotifications:!0,soundEnabled:!0,callSounds:!0,chatSounds:!0,language:a.language||"tr",autoAssign:!0});T.useEffect(()=>{(async()=>{try{d(!0);const t=await wa.getAll();A(t),t.language&&t.language!==a.language&&await a.changeLanguage(t.language),e.debug("Preferences loaded",t)}catch(t){e.error("Failed to load preferences",t)}finally{d(!1)}})()},[a]),T.useEffect(()=>{if(s){const e={name:s.name||t("profile.defaultName"),email:s.email||t("profile.defaultEmail"),phone:"",bio:""};v(e),N(e)}},[s,t]);const E=async(s,r)=>{const l=I[s];A(e=>({...e,[s]:r})),b(!0);try{await wa.update(s,r),"language"===s&&"string"==typeof r?(await a.changeLanguage(r),o(t("profile.languageChanged"))):o(t("profile.preferenceSaved")),e.debug("Preference saved",{key:s,value:r})}catch(n){A(e=>({...e,[s]:l})),e.error("Failed to save preference",n),g(t("profile.preferencesFailed"))}finally{b(!1)}};return n?w.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:w.jsx("div",{className:"max-w-4xl mx-auto",children:w.jsx(m,{})})}):w.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:w.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:t("profile.title")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("profile.subtitle")})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:t("profile.sections.profileInfo")}),p?w.jsxs("div",{className:"flex gap-2",children:[w.jsxs("button",{onClick:()=>{N(f),y(!1)},className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",type:"button",children:[w.jsx(G,{className:"w-4 h-4"}),t("common:cancel")]}),w.jsxs("button",{onClick:async()=>{if(null==s?void 0:s.id)try{v(k),y(!1),o(t("profile.profileUpdated")),e.debug("Profile updated (mock)",k)}catch(a){e.error("Failed to update profile",a),g(t("profile.profileUpdateFailed"))}},disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",type:"button",children:[c?w.jsx("div",{className:"flex items-center justify-center gap-0.5 w-4 h-4",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-white animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):w.jsx(Qe,{className:"w-4 h-4"}),t("common:save")]})]}):w.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",type:"button",children:[w.jsx(Be,{className:"w-4 h-4"}),t("profile.edit")]})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{children:p?w.jsxs("div",{children:[w.jsxs("label",{htmlFor:"agent-name",className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(L,{className:"w-4 h-4"}),t("profile.fields.name")]}),w.jsx("input",{id:"agent-name",type:"text",value:k.name,onChange:e=>N(t=>({...t,name:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"})]}):w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(L,{className:"w-4 h-4"}),t("profile.fields.name")]}),w.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:f.name})]})}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(Me,{className:"w-4 h-4"}),t("profile.fields.email")]}),w.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:f.email}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:t("profile.fields.emailImmutable")})]}),f.phone&&w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(X,{className:"w-4 h-4"}),t("profile.fields.phone")]}),w.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:f.phone})]}),(null==s?void 0:s.role)&&w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(ze,{className:"w-4 h-4"}),t("profile.fields.role")]}),w.jsx("p",{className:"text-gray-900 dark:text-gray-100 capitalize",children:s.role})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[w.jsx(Ie,{className:"w-4 h-4"}),t("profile.fields.joinDate")]}),w.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:st(new Date,a.language,{year:"numeric",month:"long",day:"numeric"})})]})]})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4",children:t("profile.sections.security")}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-gray-900 dark:text-gray-100 font-medium",children:t("profile.security.passwordReset")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("profile.security.sendResetLink")})]}),w.jsxs("button",{onClick:async()=>{if(!f.email)return void g(t("profile.security.emailNotFound"));S(!0);const a=u(t("profile.security.sendingResetEmail"));try{await bt(f.email),h(a),o(t("profile.security.resetEmailSent",{email:f.email}),5e3)}catch(s){h(a),e.error("Password reset failed",s),g(t("profile.security.resetEmailFailed"))}finally{S(!1)}},disabled:C,className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors disabled:opacity-50",type:"button",children:[C?w.jsx("div",{className:"flex items-center justify-center gap-0.5 w-4 h-4",children:[0,1,2].map(e=>w.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-700 dark:bg-gray-300 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):w.jsx(Ge,{className:"w-4 h-4"}),t("profile.security.resetButton")]})]})]}),w.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[w.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-6",children:t("profile.sections.preferences")}),w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:["dark"===r?w.jsx(Ke,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):w.jsx(Ue,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.preferences.theme.label")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("dark"===r?"profile.preferences.theme.dark":"profile.preferences.theme.light")})]})]}),w.jsx("button",{onClick:async()=>{const t="dark"===r?"light":"dark";l();try{await wa.update("theme",t),e.debug("Theme preference saved",{theme:t})}catch(a){e.error("Failed to save theme preference",a)}},"aria-label":t("profile.settingsLabels.changeTheme"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 bg-gray-300 dark:bg-orange-500",type:"button",children:w.jsx("span",{className:("dark"===r?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(Me,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.preferences.emailNotifications.label")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("profile.preferences.emailNotifications.description")})]})]}),w.jsx("button",{onClick:()=>E("emailNotifications",!I.emailNotifications),"aria-label":t("profile.settingsLabels.emailNotifications"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(I.emailNotifications?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:w.jsx("span",{className:(I.emailNotifications?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(z,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.preferences.pushNotifications.label")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("profile.preferences.pushNotifications.description")})]})]}),w.jsx("button",{onClick:()=>E("pushNotifications",!I.pushNotifications),"aria-label":t("profile.settingsLabels.pushNotifications"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(I.pushNotifications?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:w.jsx("span",{className:(I.pushNotifications?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(ne,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.preferences.soundEffects.label")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("profile.preferences.soundEffects.description")})]})]}),w.jsx("button",{onClick:()=>E("soundEnabled",!I.soundEnabled),"aria-label":t("profile.settingsLabels.soundEffects"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(I.soundEnabled?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:w.jsx("span",{className:(I.soundEnabled?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx($,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.preferences.autoAssign.label")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("profile.preferences.autoAssign.description")})]})]}),w.jsx("button",{onClick:()=>E("autoAssign",!I.autoAssign),"aria-label":t("profile.settingsLabels.autoAssign"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(I.autoAssign?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:w.jsx("span",{className:(I.autoAssign?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(qe,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t("profile.languageLabel")}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("profile.languageDescription")})]})]}),w.jsxs("select",{value:I.language,onChange:e=>E("language",e.target.value),className:"px-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500",children:[w.jsx("option",{value:"tr",children:t("profile.languages.tr")}),w.jsx("option",{value:"en",children:t("profile.languages.en")})]})]})]})]})]})})}},Symbol.toStringTag,{value:"Module"})),Sa=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{t:e,i18n:t}=j("agent"),{user:a}=i(),[s,r]=T.useState([{id:"1",role:"assistant",content:e("aiChat.welcome.message",{name:(null==a?void 0:a.name)||e("aiChat.welcome.defaultName")}),timestamp:(new Date).toISOString(),suggestions:[e("aiChat.suggestions.todayStats"),e("aiChat.suggestions.frequentQuestions"),e("aiChat.suggestions.waitingCustomers"),e("aiChat.suggestions.teamStatus")]}]),[l,n]=T.useState(""),[o,d]=T.useState(!1),c=T.useRef(null);T.useEffect(()=>{var e;null==(e=c.current)||e.scrollIntoView({behavior:"smooth"})},[s]);const g=T.useCallback(async()=>{if(!l.trim()||o)return;const t={id:Date.now().toString(),role:"user",content:l,timestamp:(new Date).toISOString()};r(e=>[...e,t]),n(""),d(!0),setTimeout(()=>{const t={id:(Date.now()+1).toString(),role:"assistant",content:e("aiChat.responses.processing"),timestamp:(new Date).toISOString(),suggestions:[e("aiChat.suggestions.todayStats"),e("aiChat.suggestions.waitingCustomers"),e("aiChat.suggestions.performance")]};r(e=>[...e,t]),d(!1)},1500)},[l,o,e,null==a?void 0:a.id]);return w.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 dark:bg-slate-900",children:[w.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 px-4 sm:px-6 py-3 sm:py-4",children:w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[w.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-purple-500 to-blue-600 dark:from-purple-600 dark:to-blue-700 rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0",children:w.jsx(Pe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white truncate",children:e("aiChat.header.title")}),w.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 truncate",children:e("aiChat.header.subtitle")})]})]})}),w.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 md:p-6",children:w.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 sm:space-y-6",children:[s.map(a=>{return w.jsxs("div",{className:"flex gap-2 sm:gap-3 md:gap-4 "+("user"===a.role?"justify-end":""),children:["assistant"===a.role&&w.jsx("div",{className:"hidden sm:flex w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-br from-purple-500 to-blue-600 dark:from-purple-600 dark:to-blue-700 rounded-lg items-center justify-center flex-shrink-0",children:w.jsx(_,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),w.jsx("div",{className:"flex-1 max-w-full sm:max-w-2xl "+("user"===a.role?"flex justify-end":""),children:w.jsxs("div",{className:"rounded-xl sm:rounded-2xl p-3 sm:p-4 "+("user"===a.role?"bg-blue-600 dark:bg-blue-700 text-white":"bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700"),children:[w.jsx("p",{className:"whitespace-pre-wrap "+("assistant"===a.role?"text-gray-900 dark:text-white":""),children:a.content}),w.jsx("p",{className:"text-xs mt-2 "+("user"===a.role?"text-blue-100":"text-gray-500 dark:text-gray-400"),children:(s=a.timestamp,rt(new Date(s),t.language,{hour:"2-digit",minute:"2-digit"}))}),a.suggestions&&a.suggestions.length>0&&w.jsxs("div",{className:"mt-4 space-y-2",children:[w.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:e("aiChat.suggestions.title")}),a.suggestions.map((e,t)=>w.jsx("button",{onClick:()=>(e=>{n(e)})(e),className:"block w-full text-left px-3 py-2 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-lg text-sm transition-colors",type:"button",children:e},t))]})]})}),"user"===a.role&&w.jsx("div",{className:"hidden sm:flex w-7 h-7 sm:w-8 sm:h-8 bg-blue-600 dark:bg-blue-700 rounded-lg items-center justify-center flex-shrink-0",children:w.jsx(L,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})})]},a.id);var s}),o&&w.jsxs("div",{className:"flex gap-4",children:[w.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-600 dark:from-purple-600 dark:to-blue-700 rounded-lg flex items-center justify-center flex-shrink-0",children:w.jsx(_,{className:"w-5 h-5 text-white"})}),w.jsx("div",{className:"flex-1 max-w-2xl",children:w.jsx("div",{className:"bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-2xl p-4",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),w.jsx("div",{className:"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),w.jsx("div",{className:"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})})]}),w.jsx("div",{ref:c})]})}),w.jsx("div",{className:"bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-700 p-3 sm:p-4",children:w.jsxs("div",{className:"max-w-4xl mx-auto",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-end gap-2 sm:gap-3",children:[w.jsx("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg sm:rounded-xl focus-within:border-purple-500 dark:focus-within:border-purple-400 transition-colors",children:w.jsx("textarea",{value:l,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g())},placeholder:e("aiChat.askQuestion"),rows:2,className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-transparent text-sm sm:text-base text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none focus:outline-none"})}),w.jsxs("button",{onClick:g,disabled:!l.trim()||o,className:"px-4 py-2.5 sm:px-6 sm:py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 dark:from-purple-700 dark:to-blue-800 dark:hover:from-purple-800 dark:hover:to-blue-900 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm sm:text-base font-medium rounded-lg sm:rounded-xl transition-all flex items-center justify-center gap-2",type:"button",children:[w.jsx(we,{className:"w-4 h-4 sm:w-5 sm:h-5"}),w.jsx("span",{children:e("aiChat.send")})]})]}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center hidden sm:block",children:e("aiChat.disclaimer")})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{It as A,ha as C,ja as V,Gt as a,ua as b,Ca as c,Sa as d,Ze as q};
