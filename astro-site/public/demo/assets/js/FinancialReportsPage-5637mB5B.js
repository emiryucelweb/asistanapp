import{a as e,r as t,j as a,v as s,s as r,U as l,y as n,E as i,l as d}from"./index-ByjBXa3D.js";import{a as c,b as o}from"./export-helpers-v2-C1TIEgiY.js";import{m,i as x}from"./config-D68ZPno9.js";import{D as g}from"./download-Dy7gXAT9.js";import{T as p}from"./trending-down-CzIGmZct.js";import{C as h}from"./chart-pie-CSkdokUb.js";import{A as u,a as y}from"./arrow-up-right-Wgo6SBEJ.js";import"./formatters-zG5fMVnG.js";const j={summary:{"30d":{totalTenants:24,activeTenants:18,trialTenants:4,totalMonthlyRevenue:45750,totalMonthlyCosts:15280,totalProfit:30470,averageRevenuePerTenant:2541,churnRate:2.5,growthRate:15.3},"90d":{totalTenants:24,activeTenants:18,trialTenants:4,totalMonthlyRevenue:137250,totalMonthlyCosts:45840,totalProfit:91410,averageRevenuePerTenant:2541,churnRate:2.3,growthRate:18.7},"1y":{totalTenants:24,activeTenants:18,trialTenants:4,totalMonthlyRevenue:549e3,totalMonthlyCosts:183360,totalProfit:365640,averageRevenuePerTenant:2541,churnRate:2.1,growthRate:22.4}},monthlyTrend:{"30d":[{month:"Nis",revenue:38500,costs:13200,profit:25300},{month:"May",revenue:41200,costs:14100,profit:27100},{month:"Haz",revenue:43800,costs:14800,profit:29e3},{month:"Tem",revenue:45750,costs:15280,profit:30470}],"90d":[{month:"Oca",revenue:32e3,costs:11500,profit:20500},{month:"Şub",revenue:35200,costs:12200,profit:23e3},{month:"Mar",revenue:36500,costs:12800,profit:23700},{month:"Nis",revenue:38500,costs:13200,profit:25300},{month:"May",revenue:41200,costs:14100,profit:27100},{month:"Haz",revenue:43800,costs:14800,profit:29e3},{month:"Tem",revenue:45750,costs:15280,profit:30470}],"1y":[{month:"Ağu 23",revenue:28e3,costs:10200,profit:17800},{month:"Eyl 23",revenue:30500,costs:10800,profit:19700},{month:"Eki 23",revenue:31200,costs:11100,profit:20100},{month:"Kas 23",revenue:33500,costs:11600,profit:21900},{month:"Ara 23",revenue:35e3,costs:12e3,profit:23e3},{month:"Oca 24",revenue:32e3,costs:11500,profit:20500},{month:"Şub 24",revenue:35200,costs:12200,profit:23e3},{month:"Mar 24",revenue:36500,costs:12800,profit:23700},{month:"Nis 24",revenue:38500,costs:13200,profit:25300},{month:"May 24",revenue:41200,costs:14100,profit:27100},{month:"Haz 24",revenue:43800,costs:14800,profit:29e3},{month:"Tem 24",revenue:45750,costs:15280,profit:30470}]},planDistribution:[{plan:"Enterprise",count:6,revenue:15e3,percentage:32.8},{plan:"Professional",count:8,revenue:19980,percentage:43.7},{plan:"Starter",count:4,revenue:7980,percentage:17.4},{plan:"Trial",count:6,revenue:2790,percentage:6.1}],topTenants:[{name:"Acme E-commerce",revenue:2500,profit:1618,growth:12.5},{name:"TechStart SaaS",revenue:2400,profit:1547,growth:18.2},{name:"HealthCare Plus",revenue:2200,profit:1091,growth:-5.3},{name:"Fashion Boutique",revenue:1999,profit:1299,growth:22.1},{name:"Food Delivery Co",revenue:1899,profit:1234,growth:8.7}],costBreakdown:{"30d":[{category:"LLM API",amount:8500,percentage:55.6},{category:"Voice Services",amount:3200,percentage:20.9},{category:"WhatsApp",amount:2100,percentage:13.7},{category:"Storage",amount:980,percentage:6.4},{category:"Other",amount:500,percentage:3.3}],"90d":[{category:"LLM API",amount:25500,percentage:55.6},{category:"Voice Services",amount:9600,percentage:20.9},{category:"WhatsApp",amount:6300,percentage:13.7},{category:"Storage",amount:2940,percentage:6.4},{category:"Other",amount:1500,percentage:3.3}],"1y":[{category:"LLM API",amount:102e3,percentage:55.6},{category:"Voice Services",amount:38400,percentage:20.9},{category:"WhatsApp",amount:25200,percentage:13.7},{category:"Storage",amount:11760,percentage:6.4},{category:"Other",amount:6e3,percentage:3.3}]}},f={getFinancialSummary:async(e="30d")=>(await m(),j.summary[e]),getMonthlyTrend:async(e="30d")=>(await m(),j.monthlyTrend[e]),getPlanDistribution:async()=>(await m(),j.planDistribution),getTopTenants:async(e=5)=>(await m(),j.topTenants.slice(0,e)),getCostBreakdown:async(e="30d")=>(await m(),j.costBreakdown[e])},b=()=>{const{t:o}=e("super-admin"),[m,j]=t.useState(null),[b,v]=t.useState([]),[N,w]=t.useState([]),[k,S]=t.useState([]),[$,T]=t.useState([]),[M,R]=t.useState("30d"),[F,A]=t.useState(!1),[P,L]=t.useState(!1),D=m?m.totalProfit/m.totalMonthlyRevenue*100:0,C=f;t.useEffect(()=>{(async()=>{L(!0);try{const[e,t,a,s,r]=await Promise.all([C.getFinancialSummary(M),C.getMonthlyTrend(M),C.getPlanDistribution(),C.getTopTenants(5),C.getCostBreakdown(M)]);j(e),v(t),w(a),S(s),T(r),d.info("[FinancialReports] All data fetched",{period:M,mode:x()?"mock":"real"})}catch(e){d.error("[FinancialReports] Fetch failed",{error:e})}finally{L(!1)}})()},[M]);return P&&!m?a.jsx("div",{className:"p-4 sm:p-6 lg:p-8 flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[0,1,2].map(e=>a.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:o("financial.messages.loading")})]})}):m?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:o("financial.title")}),a.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:o("financial.subtitle")})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("select",{value:M,onChange:e=>R(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",children:[a.jsx("option",{value:"30d",children:o("financial.periods.30d")}),a.jsx("option",{value:"90d",children:o("financial.periods.90d")}),a.jsx("option",{value:"1y",children:o("financial.periods.1y")})]}),a.jsx("div",{className:"relative",children:a.jsxs("button",{onClick:()=>(async e=>{if(m){A(!0);try{const t={config:{title:o("financial.title"),subtitle:"AsistanApp Super Admin",description:`${o("financial.subtitle")} - ${o(`super-admin.financial.periods.${M}`)}`,dateRange:(new Date).toLocaleDateString("tr-TR"),metadata:{generatedBy:"Super Admin",generatedAt:(new Date).toISOString(),company:"AsistanApp"}},stats:{title:"Genel Özet",items:[{label:"Toplam Gelir",value:`$${m.totalMonthlyRevenue.toLocaleString()}`},{label:"Toplam Maliyet",value:`$${m.totalMonthlyCosts.toLocaleString()}`},{label:"Net Kar",value:`$${m.totalProfit.toLocaleString()}`},{label:"Kar Marjı",value:`${D.toFixed(1)}%`},{label:"Aktif Firma",value:m.activeTenants.toString()},{label:"Ort. Gelir/Firma",value:`$${m.averageRevenuePerTenant.toLocaleString()}`}]},tables:[{title:"Aylık Trend",headers:["Ay","Gelir","Maliyet","Kar"],rows:b.map(e=>[e.month,`$${e.revenue}`,`$${e.costs}`,`$${e.profit}`])},{title:"Plan Dağılımı",headers:["Plan","Firma Sayısı","Gelir","Oran"],rows:N.map(e=>[e.plan,e.count.toString(),`$${e.revenue}`,`${e.percentage}%`])},{title:"En Karlı Firmalar",headers:["Firma","Gelir","Kar","Büyüme"],rows:k.map(e=>[e.name,`$${e.revenue}`,`$${e.profit}`,`${e.growth>0?"+":""}${e.growth}%`])},{title:"Maliyet Dağılımı",headers:["Kategori","Tutar","Oran"],rows:$.map(e=>[e.category,`$${e.amount}`,`${e.percentage}%`])}]};"excel"===e&&(await c(t),d.info("[FinancialReports] Excel export successful"))}catch(t){d.error("[FinancialReports] Export failed",{error:t}),alert(o("financial.messages.exportFailed"))}finally{A(!1)}}else alert(o("financial.messages.noDataYet"))})("excel"),disabled:F||P,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(g,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:o(F?"financial.export.exporting":P?"financial.export.loading":"financial.export.button")})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg p-6 text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm opacity-90",children:"Toplam Gelir"}),a.jsx(s,{className:"w-5 h-5 opacity-90"})]}),a.jsxs("p",{className:"text-3xl font-bold",children:["$",m.totalMonthlyRevenue.toLocaleString()]}),a.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm",children:[a.jsx(r,{className:"w-4 h-4"}),a.jsxs("span",{children:["+",m.growthRate,"% büyüme"]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg p-6 text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm opacity-90",children:"Toplam Maliyet"}),a.jsx(p,{className:"w-5 h-5 opacity-90"})]}),a.jsxs("p",{className:"text-3xl font-bold",children:["$",m.totalMonthlyCosts.toLocaleString()]}),a.jsx("div",{className:"flex items-center gap-1 mt-2 text-sm",children:a.jsxs("span",{children:[(m.totalMonthlyCosts/m.totalMonthlyRevenue*100).toFixed(1),"% of revenue"]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg p-6 text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm opacity-90",children:"Net Kar"}),a.jsx(r,{className:"w-5 h-5 opacity-90"})]}),a.jsxs("p",{className:"text-3xl font-bold",children:["$",m.totalProfit.toLocaleString()]}),a.jsx("div",{className:"flex items-center gap-1 mt-2 text-sm",children:a.jsxs("span",{children:[D.toFixed(1),"% kar marjı"]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg p-6 text-white",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm opacity-90",children:"Aktif Firmalar"}),a.jsx(l,{className:"w-5 h-5 opacity-90"})]}),a.jsx("p",{className:"text-3xl font-bold",children:m.activeTenants}),a.jsx("div",{className:"flex items-center gap-1 mt-2 text-sm",children:a.jsxs("span",{children:["/",m.totalTenants," toplam firma"]})})]})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center gap-2",children:[a.jsx(n,{className:"w-5 h-5"}),"Gelir Trendi"]}),a.jsx("div",{className:"space-y-4",children:b.map((e,t)=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.month}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["$",e.revenue.toLocaleString()]}),a.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["$",e.costs.toLocaleString()]}),a.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:["$",e.profit.toLocaleString()]})]})]}),a.jsxs("div",{className:"flex gap-1 h-8",children:[a.jsx("div",{className:"bg-green-500 dark:bg-green-600 rounded",style:{width:e.revenue/5e4*100+"%"},title:`Gelir: $${e.revenue}`}),a.jsx("div",{className:"bg-red-500 dark:bg-red-600 rounded",style:{width:e.costs/5e4*100+"%"},title:`Maliyet: $${e.costs}`})]})]},t))}),a.jsxs("div",{className:"flex items-center justify-center gap-6 mt-6 pt-6 border-t border-gray-200 dark:border-slate-700",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gelir"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Maliyet"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Kar"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center gap-2",children:[a.jsx(h,{className:"w-5 h-5"}),"Plan Dağılımı"]}),a.jsx("div",{className:"space-y-4",children:N.map((e,t)=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.plan}),a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",e.count," firma)"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:["$",e.revenue.toLocaleString()]}),a.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 dark:bg-blue-400 h-2 rounded-full transition-all",style:{width:`${e.percentage}%`}})})]},t))})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center gap-2",children:[a.jsx(n,{className:"w-5 h-5"}),"Maliyet Dağılımı"]}),a.jsx("div",{className:"space-y-4",children:$.map((e,t)=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.category}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:["$",e.amount.toLocaleString()]}),a.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700 rounded-full h-2",children:a.jsx("div",{className:"bg-orange-600 dark:bg-orange-400 h-2 rounded-full transition-all",style:{width:`${e.percentage}%`}})})]},t))})]})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:"En İyi Performans Gösteren Firmalar"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"border-b border-gray-200 dark:border-slate-700",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Sıra"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Firma"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Aylık Gelir"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Net Kar"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Büyüme"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-slate-700",children:k.map((e,t)=>a.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50",children:[a.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-semibold text-sm",children:t+1})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.name})]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:["$",e.revenue.toLocaleString()]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:["$",e.profit.toLocaleString()]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsx("div",{className:"flex items-center justify-end gap-1",children:e.growth>0?a.jsxs(a.Fragment,{children:[a.jsx(u,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),a.jsxs("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:["+",e.growth,"%"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(y,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),a.jsxs("span",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:[e.growth,"%"]})]})})})]},t))})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg",children:a.jsx(r,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-300",children:"Güçlü Büyüme"}),a.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-400 mt-1",children:["Son 30 günde %",m.growthRate," büyüme kaydedildi"]})]})]})}),a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/40 rounded-lg",children:a.jsx(s,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-green-900 dark:text-green-300",children:"Sağlıklı Kar Marjı"}),a.jsxs("p",{className:"text-xs text-green-700 dark:text-green-400 mt-1",children:["%",D.toFixed(1)," kar marjı ile hedefin üzerinde"]})]})]})}),a.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:a.jsx(l,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-purple-900 dark:text-purple-300",children:o("financial.insights.lowChurn")}),a.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-400 mt-1",children:o("financial.insights.lowChurnDesc",{rate:m.churnRate})})]})]})})]})]}):a.jsx("div",{className:"p-4 sm:p-6 lg:p-8 flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:o("financial.messages.loadFailed")})})})};export{b as default};
