import{c as e,ag as a,l as t,a as s,b as r,Q as i,r as l,j as n,ap as o,X as c,m as d,P as g,E as m,w as x,x as f,K as u,a3 as p,n as h,H as y,G as b,aq as j,ar as N,as as k}from"./index-BDKevNej.js";import{S as w,K as v}from"./save-B96ne7UV.js";import{M as S}from"./mail-CzR1jFZZ.js";import{C}from"./calendar-DKgWgsf7.js";import{G as E}from"./globe-CQ2O9vVS.js";
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=e("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),O=async e=>(await a.post("/auth/reset-password",{email:e})).data,A="agent_preferences",K={emailNotifications:!0,pushNotifications:!0,desktopNotifications:!0,soundEnabled:!0,callSounds:!0,chatSounds:!0,language:"tr",autoAssign:!0,theme:"light"};const M=new class{async getAll(){await this.simulateNetworkDelay();try{const e=localStorage.getItem(A);if(!e)return t.debug("[MOCK] No preferences found, returning defaults"),{...K};const a=JSON.parse(e);return t.debug("[MOCK] Preferences loaded from localStorage",a),{...K,...a}}catch(e){return t.error("[MOCK] Failed to load preferences",e),{...K}}}async update(e,a){await this.simulateNetworkDelay();try{const s={...await this.getAll(),[e]:a};return localStorage.setItem(A,JSON.stringify(s)),t.debug("[MOCK] Preference updated",{key:e,value:a}),s}catch(s){throw t.error("[MOCK] Failed to save preference",s),new Error("Failed to save preference")}}async updateMultiple(e){await this.simulateNetworkDelay();try{const a={...await this.getAll(),...e};return localStorage.setItem(A,JSON.stringify(a)),t.debug("[MOCK] Preferences updated",{preferences:e}),a}catch(a){throw t.error("[MOCK] Failed to save preferences",a),new Error("Failed to save preferences")}}async reset(){await this.simulateNetworkDelay();try{return localStorage.setItem(A,JSON.stringify(K)),t.debug("[MOCK] Preferences reset to defaults"),{...K}}catch(e){throw t.error("[MOCK] Failed to reset preferences",e),new Error("Failed to reset preferences")}}async simulateNetworkDelay(){return new Promise(e=>setTimeout(e,300))}};t.info("[PreferencesService] Using MOCK (localStorage) implementation");const D=()=>{const{t:e,i18n:a}=s("agent"),{user:A}=r(),{theme:K,toggleTheme:D}=i(),[P,L]=l.useState(!1),[I,J]=l.useState(!1),[T,R]=l.useState(!1),[U,z]=l.useState({name:"",email:"",phone:"",bio:""}),[G,q]=l.useState(U),[B,H]=l.useState(!1),[Q,Z]=l.useState({emailNotifications:!0,pushNotifications:!0,desktopNotifications:!0,soundEnabled:!0,callSounds:!0,chatSounds:!0,language:a.language||"tr",autoAssign:!0});l.useEffect(()=>{(async()=>{try{L(!0);const e=await M.getAll();Z(e),e.language&&e.language!==a.language&&await a.changeLanguage(e.language),t.debug("Preferences loaded",e)}catch(e){t.error("Failed to load preferences",e)}finally{L(!1)}})()},[a]),l.useEffect(()=>{if(A){const a={name:A.name||e("profile.defaultName"),email:A.email||e("profile.defaultEmail"),phone:"",bio:""};z(a),q(a)}},[A,e]);const _=async(s,r)=>{const i=Q[s];Z(e=>({...e,[s]:r})),J(!0);try{await M.update(s,r),"language"===s&&"string"==typeof r?(await a.changeLanguage(r),y(e("profile.languageChanged"))):y(e("profile.preferenceSaved")),t.debug("Preference saved",{key:s,value:r})}catch(l){Z(e=>({...e,[s]:i})),t.error("Failed to save preference",l),b(e("profile.preferencesFailed"))}finally{J(!1)}};return P?n.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:n.jsx("div",{className:"max-w-4xl mx-auto",children:n.jsx(o,{})})}):n.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:e("profile.title")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e("profile.subtitle")})]}),n.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:e("profile.sections.profileInfo")}),T?n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>{q(U),R(!1)},className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",type:"button",children:[n.jsx(c,{className:"w-4 h-4"}),e("common:cancel")]}),n.jsxs("button",{onClick:async()=>{if(null==A?void 0:A.id)try{z(G),R(!1),y(e("profile.profileUpdated")),t.debug("Profile updated (mock)",G)}catch(a){t.error("Failed to update profile",a),b(e("profile.profileUpdateFailed"))}},disabled:I,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",type:"button",children:[I?n.jsx("div",{className:"flex items-center justify-center gap-0.5 w-4 h-4",children:[0,1,2].map(e=>n.jsx("div",{className:"w-1 h-1 rounded-full bg-white animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):n.jsx(w,{className:"w-4 h-4"}),e("common:save")]})]}):n.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",type:"button",children:[n.jsx(F,{className:"w-4 h-4"}),e("profile.edit")]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{children:T?n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"agent-name",className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(d,{className:"w-4 h-4"}),e("profile.fields.name")]}),n.jsx("input",{id:"agent-name",type:"text",value:G.name,onChange:e=>q(a=>({...a,name:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"})]}):n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(d,{className:"w-4 h-4"}),e("profile.fields.name")]}),n.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:U.name})]})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(S,{className:"w-4 h-4"}),e("profile.fields.email")]}),n.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:U.email}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e("profile.fields.emailImmutable")})]}),U.phone&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(g,{className:"w-4 h-4"}),e("profile.fields.phone")]}),n.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:U.phone})]}),(null==A?void 0:A.role)&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(m,{className:"w-4 h-4"}),e("profile.fields.role")]}),n.jsx("p",{className:"text-gray-900 dark:text-gray-100 capitalize",children:A.role})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(C,{className:"w-4 h-4"}),e("profile.fields.joinDate")]}),n.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:j(new Date,a.language,{year:"numeric",month:"long",day:"numeric"})})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4",children:e("profile.sections.security")}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-900 dark:text-gray-100 font-medium",children:e("profile.security.passwordReset")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e("profile.security.sendResetLink")})]}),n.jsxs("button",{onClick:async()=>{if(!U.email)return void b(e("profile.security.emailNotFound"));H(!0);const a=N(e("profile.security.sendingResetEmail"));try{await O(U.email),k(a),y(e("profile.security.resetEmailSent",{email:U.email}),5e3)}catch(s){k(a),t.error("Password reset failed",s),b(e("profile.security.resetEmailFailed"))}finally{H(!1)}},disabled:B,className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors disabled:opacity-50",type:"button",children:[B?n.jsx("div",{className:"flex items-center justify-center gap-0.5 w-4 h-4",children:[0,1,2].map(e=>n.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-700 dark:bg-gray-300 animate-bounce",style:{animationDelay:.15*e+"s",animationDuration:"0.6s"}},e))}):n.jsx(v,{className:"w-4 h-4"}),e("profile.security.resetButton")]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-6",children:e("profile.sections.preferences")}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["dark"===K?n.jsx(x,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):n.jsx(f,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.preferences.theme.label")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("dark"===K?"profile.preferences.theme.dark":"profile.preferences.theme.light")})]})]}),n.jsx("button",{onClick:async()=>{const e="dark"===K?"light":"dark";D();try{await M.update("theme",e),t.debug("Theme preference saved",{theme:e})}catch(a){t.error("Failed to save theme preference",a)}},"aria-label":e("profile.settingsLabels.changeTheme"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 bg-gray-300 dark:bg-orange-500",type:"button",children:n.jsx("span",{className:("dark"===K?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(S,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.preferences.emailNotifications.label")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("profile.preferences.emailNotifications.description")})]})]}),n.jsx("button",{onClick:()=>_("emailNotifications",!Q.emailNotifications),"aria-label":e("profile.settingsLabels.emailNotifications"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(Q.emailNotifications?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:n.jsx("span",{className:(Q.emailNotifications?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(u,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.preferences.pushNotifications.label")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("profile.preferences.pushNotifications.description")})]})]}),n.jsx("button",{onClick:()=>_("pushNotifications",!Q.pushNotifications),"aria-label":e("profile.settingsLabels.pushNotifications"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(Q.pushNotifications?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:n.jsx("span",{className:(Q.pushNotifications?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(p,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.preferences.soundEffects.label")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("profile.preferences.soundEffects.description")})]})]}),n.jsx("button",{onClick:()=>_("soundEnabled",!Q.soundEnabled),"aria-label":e("profile.settingsLabels.soundEffects"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(Q.soundEnabled?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:n.jsx("span",{className:(Q.soundEnabled?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(h,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.preferences.autoAssign.label")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("profile.preferences.autoAssign.description")})]})]}),n.jsx("button",{onClick:()=>_("autoAssign",!Q.autoAssign),"aria-label":e("profile.settingsLabels.autoAssign"),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 "+(Q.autoAssign?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"),type:"button",children:n.jsx("span",{className:(Q.autoAssign?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-white transition-transform"})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(E,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e("profile.languageLabel")}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("profile.languageDescription")})]})]}),n.jsxs("select",{value:Q.language,onChange:e=>_("language",e.target.value),className:"px-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500",children:[n.jsx("option",{value:"tr",children:e("profile.languages.tr")}),n.jsx("option",{value:"en",children:e("profile.languages.en")})]})]})]})]})]})})};export{D as default};
